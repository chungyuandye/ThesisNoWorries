(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    278348,       6931]
NotebookOptionsPosition[    277709,       6907]
NotebookOutlinePosition[    278100,       6923]
CellTagsIndexPosition[    278057,       6920]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ANOVA`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<RLink`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{
  "(*", "\:6839\:64da\:4f5c\:696d\:7cfb\:7d71\:8f09\:5165R\:8def\:5f91", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"$Version", ",", "6"}], "]"}], "==", "\"\<12.3.0\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Needs", "[", "\"\<RLink`\>\"", "]"}], "\n", 
       RowBox[{"JLink`UninstallJava", "[", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"InstallR", "[", 
       RowBox[{
        RowBox[{"\"\<RVersion\>\"", "\[Rule]", "\"\<4.1.0\>\""}], ",", 
        RowBox[{
        "\"\<RHomeLocation\>\"", "\[Rule]", 
         "\"\</Library/Frameworks/R.framework/Resources\>\""}], ",", 
        RowBox[{
        "\"\<NativeLibLocation\>\"", "\[Rule]", 
         "\"\</Library/Frameworks/R.framework/Resources/Library/rJava/jri\>\"\
"}]}], "]"}], ";", "\n", 
      RowBox[{"REvaluate", "[", "\"\<R.version.string\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"$Version", ",", "\"\<Windows\>\""}], "]"}], ",", 
       RowBox[{
        RowBox[{"InstallR", "[", 
         RowBox[{
         "\"\<RHomeLocation\>\"", "\[Rule]", 
          "\"\<C:\\\\Program Files\\\\R\\\\R-3.0.0\>\""}], "]"}], ";"}], ",", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"$Version", ",", "\"\<Linux\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{"SetEnvironment", "[", 
           RowBox[{
           "\"\<LD_LIBRARY_PATH\>\"", "\[Rule]", "\"\</usr/lib/R/lib\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"InstallR", "[", 
           RowBox[{
            RowBox[{
            "\"\<RHomeLocation\>\"", "\[Rule]", "\"\</usr/lib/R\>\""}], ",", 
            RowBox[{"\"\<RVersion\>\"", "\[Rule]", "\"\<R-3.2.4\>\""}]}], 
           "]"}], ";"}], ",", 
         RowBox[{
          RowBox[{"Needs", "@", "\"\<JLink`\>\""}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SetEnvironment", "[", 
           RowBox[{
           "\"\<DYLD_LIBRARY_PATH\>\"", "\[Rule]", 
            "\"\</Library/Frameworks/R.framework/Resources/lib\>\""}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"InstallR", "[", 
           RowBox[{
            RowBox[{"\"\<RVersion\>\"", "\[Rule]", "3"}], ",", 
            RowBox[{
            "\"\<RHomeLocation\>\"", "\[Rule]", 
             "\"\</Library/Frameworks/R.framework/Resources\>\""}], ",", 
            RowBox[{
            "\"\<NativeLibLocation\>\"", "\[Rule]", 
             "\"\</Library/Frameworks/R.framework/Resources/Library/rJava/JRI\
\>\""}]}], "]"}], ";"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "Windows"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"InstallR", "[", 
    RowBox[{
    "\"\<RHomeLocation\>\"", "\[Rule]", 
     "\"\<C:\\\\Program Files\\\\R\\\\R-3.0.0\>\""}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "Linux"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetEnvironment", "[", 
     RowBox[{"\"\<LD_LIBRARY_PATH\>\"", "\[Rule]", "\"\</usr/lib/R/lib\>\""}],
      "]"}], " ", 
    RowBox[{"InstallR", "[", 
     RowBox[{
      RowBox[{"\"\<RHomeLocation\>\"", "\[Rule]", "\"\</usr/lib/R\>\""}], ",", 
      RowBox[{"\"\<RVersion\>\"", "\[Rule]", "\"\<R-3.2.3\>\""}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "@", 
    RowBox[{"REvaluate", "[", "\"\<R.version.string\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "REvaluate", "[", "\"\<install.packages(\\\"lavaan\\\")\>\"", "]"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"REvaluate", "[", "\"\<library(lavaan);\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"REvaluate", "[", "\"\<library(semTools);\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myreg", "[", 
     RowBox[{"data1_", ",", "data2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "num1", ",", "num2", ",", "vars", ",", "mymodel", ",", "mycoef", ",", 
        "myr2", ",", "myreport", ",", "myanova", ",", "yy", ",", "mypvalue", 
        ",", "mycolumn"}], "}"}], ",", 
      RowBox[{
       RowBox[{"num1", "=", 
        RowBox[{"Length", "@", "data1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"num2", "=", 
        RowBox[{"Length", "@", "data2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<X\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "num1", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"mymodel", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"LinearModelFit", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"Insert", "[", 
              RowBox[{"data1", ",", 
               RowBox[{"data2", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ",", "vars", ",", "vars"}], 
           "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "num2", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"mycoef", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"mymodel", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<ParameterTable\>\"", 
              "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"3", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "num2", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"mycoef", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "@", "#"}], "<", "0.0001"}], ",", "0", ",", 
             "#"}], "]"}], "&"}], ",", "mycoef", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "@", "mycoef"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myr2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mymodel", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<RSquared\>\"", "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", "num2", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"myreport", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"myreport", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "\"\<\>\""}], "}"}], "&"}], "/@", "myr2"}], 
           "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myr2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"mymodel", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<AdjustedRSquared\>\"", 
           "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "num2", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"myreport", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"myreport", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "\"\<\>\""}], "}"}], "&"}], "/@", "myr2"}], 
           "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myanova", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{
             RowBox[{"mymodel", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "[", 
             "\"\<ANOVATableFStatistics\>\"", "]"}]}], "/", "num1"}], "&"}], "/@", 
         RowBox[{"Range", "[", "num2", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"myreport", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"myreport", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "\"\<\>\""}], "}"}], "&"}], "/@", "myanova"}],
            "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mypvalue", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Probability", "[", 
           RowBox[{
            RowBox[{"yy", "\[GreaterEqual]", "#"}], ",", 
            RowBox[{"yy", "\[Distributed]", 
             RowBox[{"FRatioDistribution", "[", 
              RowBox[{"num1", ",", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"data1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", "1", "-", "num1"}]}],
               "]"}]}]}], "]"}], "&"}], "/@", "myanova"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mypvalue", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "@", "#"}], "<", "0.0001"}], ",", "0", ",", "#"}],
            "]"}], "&"}], "/@", "mypvalue"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"myreport", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "\"\<\>\""}], "}"}], "&"}], "/@", 
            "mypvalue"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mycolumn", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
          "vars", ",", "\"\<R^2\>\"", ",", "\"\<Adj_R^2\>\"", ",", 
           "\"\<F\>\"", ",", "\"\<P value\>\""}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"mycolumn", ",", "myreport"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"myreport", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<\:8b8a\:6578\>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\:4f30\:8a08\:503c\>\"", ",", "\"\<P \:503c\>\""}], 
                "}"}], "&"}], "/@", 
              RowBox[{"Range", "[", "num2", "]"}]}]}], "}"}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberForm", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"5", ",", "3"}], "}"}]}], "]"}], "&"}], ",", "myreport", 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myhlm", "[", 
     RowBox[{"datax_", ",", "datam_", ",", "datay_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numx", ",", "numm", ",", "numy", ",", "myreportxm", ",", "myreportxy",
         ",", "myreportmy", ",", "rulexm", ",", "rulemy", ",", " ", ",", 
        "rulexmy", ",", "myreportxmy"}], "}"}], ",", 
      RowBox[{
       RowBox[{"numx", "=", 
        RowBox[{"Length", "@", "datax"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numm", "=", 
        RowBox[{"Length", "@", "datam"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numy", "=", 
        RowBox[{"Length", "@", "datay"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreportxm", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"myreg", "[", 
           RowBox[{"datax", ",", "datam"}], "]"}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<M\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", "\"\<\>\""}], 
                "}"}], "&"}], "/@", 
              RowBox[{"Range", "[", "numm", "]"}]}]}], "}"}]}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreportxy", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"myreg", "[", 
           RowBox[{"datax", ",", "datay"}], "]"}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Y\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", "\"\<\>\""}], 
                "}"}], "&"}], "/@", 
              RowBox[{"Range", "[", "numy", "]"}]}]}], "}"}]}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreportmy", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"myreg", "[", 
           RowBox[{"datam", ",", "datay"}], "]"}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Y\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", "\"\<\>\""}], 
                "}"}], "&"}], "/@", 
              RowBox[{"Range", "[", "numy", "]"}]}]}], "}"}]}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rulemy", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<X\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<M\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", "numm", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"myreportmy", "=", 
        RowBox[{"myreportmy", "/.", "rulemy"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"myreportxmy", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"myreportxy", ",", 
            RowBox[{
             RowBox[{"myreg", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"datax", ",", "datam"}], "]"}], ",", "datay"}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rulemy", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<X\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"numx", "+", "#"}], "]"}]}], "]"}], "\[Rule]", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<M\>\"", "<>", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", "numm", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"myreportxmy", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
           RowBox[{"myreportxmy", "/.", "rulemy"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "//", "TableForm"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreportxm", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
           "myreportxm", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "//", "TableForm"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreportxy", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
           "myreportxy", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "//", "TableForm"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreportmy", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
           "myreportmy", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "//", "TableForm"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<X->Y\\n\>\"", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
            "myreportxy", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", "\"\<\\nX->M\\n\>\"", ",", 
          
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
            "myreportxm", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", "\"\<\\nM->Y\\n\>\"", ",", 
          
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
            "myreportmy", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], ",", "\"\<\\nX,M->Y\>\"", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
            RowBox[{"myreportxmy", "/.", "rulemy"}], ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], "}"}], "//", "Column"}]}]}], 
     "]"}]}], ";"}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mycronbach", "[", 
     RowBox[{"datax_", ",", "factornum_", ",", "varstring_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numx", ",", "numf", ",", "seq", ",", "newdatax", ",", "myalpha"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"numx", "=", 
        RowBox[{"Length", "@", "datax"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numf", "=", 
        RowBox[{"Length", "@", "factornum"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seq", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornum"}], "}"}]}], "]"}], ",", "2", ",", 
           "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatax", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"datax", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}], "&"}], "/@", 
         "seq"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myalpha", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"factornum", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"factornum", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "-", "1"}], ")"}]}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"Variance", "/@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"newdatax", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], "/", 
                  RowBox[{"Variance", "[", 
                   RowBox[{"Total", "/@", 
                    RowBox[{"newdatax", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}]}], ")"}]}], 
              "&"}], "/@", 
             RowBox[{"Range", "[", "numf", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Transpose", "@", "datax"}], "]"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Transpose", "@", "datax"}], "]"}], "-", "1"}], 
               ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"Variance", "/@", 
                  RowBox[{"Transpose", "@", "datax"}]}], "]"}], "/", 
                RowBox[{"Variance", "[", 
                 RowBox[{"Total", "/@", "datax"}], "]"}]}]}], ")"}]}]}], 
           "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"varstring", ",", 
          RowBox[{"myalpha", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"myalpha", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "}"}], ",", 
            RowBox[{"Length", "@", "varstring"}], ",", "\"\<\>\""}], "]"}]}], 
         "}"}]}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworryhlm", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "datayy_", ",", "factornumx_", ",", 
      "factornumm_", ",", "factornumy_", ",", "varstringx_", ",", 
      "varstringm_", ",", "varstringy_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "datax", ",", "datam", ",", "datay", ",", "cronbach", ",", "numfx", 
        ",", "numfm", ",", "numfy", ",", "seqx", ",", "seqm", ",", "seqy", 
        ",", "newdatax", ",", "newdatam", ",", "newdatay", ",", "newdataxmy", 
        ",", "mycortest"}], "}"}], ",", 
      RowBox[{
       RowBox[{"datax", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"dataxx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "dataxx", ",", 
          RowBox[{"dataxx", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datam", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"datamm", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "datamm", ",", 
          RowBox[{"datamm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datay", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"datayy", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "datayy", ",", 
          RowBox[{"datayy", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cronbach", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mycronbach", "[", 
               RowBox[{"datax", ",", "factornumx", ",", "varstringx"}], "]"}],
               ",", 
              RowBox[{"mycronbach", "[", 
               RowBox[{"datam", ",", "factornumm", ",", "varstringm"}], "]"}],
               ",", 
              RowBox[{"mycronbach", "[", 
               RowBox[{"datay", ",", "factornumy", ",", "varstringy"}], 
               "]"}]}], "}"}], ",", "1"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cronbach", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"cronbach", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Factor\>\"", ",", "\"\<Alpha\>\"", ",", 
            "\"\<Total Alpha\>\""}], "}"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numfx", "=", 
        RowBox[{"Length", "@", "factornumx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumx"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatax", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "/@", 
           RowBox[{"datax", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
         "seqx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfm", "=", 
        RowBox[{"Length", "@", "factornumm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqm", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumm"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatam", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "/@", 
           RowBox[{"datam", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
         "seqm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfy", "=", 
        RowBox[{"Length", "@", "factornumy"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqy", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumy"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatay", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "/@", 
           RowBox[{"datay", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
         "seqy"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdataxmy", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newdatax", ",", "newdatam", ",", "newdatay"}], "}"}], ",",
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mycortest", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "0.05"}], ",", 
             
             RowBox[{
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "<>", 
              "\"\<*\>\""}], ",", 
             RowBox[{
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "<>", 
              "\"\< \>\""}]}], "]"}], "&"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PearsonCorrelationTest", "[", 
               RowBox[{
                RowBox[{"newdataxmy", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"newdataxmy", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<TestDataTable\>\"",
                 ",", 
                RowBox[{"VerifyTestAssumptions", "\[Rule]", "None"}]}], "]"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "newdataxmy"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "@", "newdataxmy"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mycortest", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"{", 
                RowBox[{"varstringx", ",", "varstringm", ",", "varstringy"}], 
                "}"}]}], ",", "mycortest"}], "}"}]}], "]"}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"varstringx", ",", "varstringm", ",", "varstringy"}], 
               "}"}]}]}], "}"}]}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\\n\:76f8\:95dc\:5206\:6790\\n\>\"", ",", 
          RowBox[{"mycortest", "//", "TableForm"}], ",", 
          "\"\<\\n\:968e\:5c64\:8ff4\:6b78\:5206\:6790\\n\>\"", ",", 
          RowBox[{"myhlm", "[", 
           RowBox[{"newdatax", ",", "newdatam", ",", "newdatay"}], "]"}]}], 
         "}"}], "//", "Column"}]}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"myanova", "[", 
      RowBox[{"dataf_", ",", "datax_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tempmsd", ",", "tempanova1", ",", "tempanova2", ",", "posthoc"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"tempmsd", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Floor", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"StandardDeviation", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], 
           "&"}], "/@", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"dataf", ",", "datax"}], "}"}]}], ",", "First"}], 
             "]"}], ",", "First"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tempanova1", "=", 
         RowBox[{"ANOVA", "[", 
          RowBox[{
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"dataf", ",", "datax"}], "}"}]}], ",", 
           RowBox[{"PostTests", "\[Rule]", "Bonferroni"}], ",", 
           RowBox[{"CellMeans", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tempanova2", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"tempmsd", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"tempanova1", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], 
              "}"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"PadRight", "[", 
              RowBox[{"#", ",", "5", ",", "\"\<\>\""}], "]"}], "&"}], "/@", 
            RowBox[{"tempmsd", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"posthoc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"Flatten", "@", 
              RowBox[{"tempanova1", "[", 
               RowBox[{"[", 
                RowBox[{
                "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
                 "2"}], "]"}], "]"}]}]}], "\[GreaterEqual]", "2"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Floor", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<>", 
                "\"\<--\>\""}], 
               RowBox[{"ToString", "[", 
                RowBox[{"Floor", "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"tempanova1", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", 
                    ",", "2"}], "]"}], "]"}]}]}], "\[Equal]", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"tempanova1", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
                   "2"}], "]"}], "]"}], "}"}], ",", 
               RowBox[{"tempanova1", "[", 
                RowBox[{"[", 
                 RowBox[{
                 "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
                  "2"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"{", "\"\<\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Transpose", "@", 
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"Transpose", "@", "tempanova2"}], ",", 
           RowBox[{"PadRight", "[", 
            RowBox[{"posthoc", ",", 
             RowBox[{"Length", "@", "tempmsd"}], ",", "\"\<\>\""}], "]"}], 
           ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myanova", "[", 
     RowBox[{"dataf_", ",", "datax_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tempmsd", ",", "tempanova1", ",", "tempanova2", ",", "posthoc"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"tempmsd", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"StandardDeviation", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], "&"}],
          "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"GatherBy", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"dataf", ",", "datax"}], "}"}]}], ",", "First"}], 
            "]"}], ",", "First"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tempanova1", "=", 
        RowBox[{"ANOVA", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"dataf", ",", "datax"}], "}"}]}], ",", 
          RowBox[{"PostTests", "\[Rule]", "Bonferroni"}], ",", 
          RowBox[{"CellMeans", "\[Rule]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempanova2", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"tempmsd", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"tempanova1", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], 
             "}"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"PadRight", "[", 
             RowBox[{"#", ",", "5", ",", "\"\<\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"tempmsd", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posthoc", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"tempanova1", "[", 
              RowBox[{"[", 
               RowBox[{
               "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
                "2"}], "]"}], "]"}]}]}], "\[GreaterEqual]", "2"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<--\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"tempanova1", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",",
                     "2"}], "]"}], "]"}]}]}], "\[Equal]", "2"}], ",", 
              RowBox[{"{", 
               RowBox[{"tempanova1", "[", 
                RowBox[{"[", 
                 RowBox[{
                 "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
                  "2"}], "]"}], "]"}], "}"}], ",", 
              RowBox[{"tempanova1", "[", 
               RowBox[{"[", 
                RowBox[{
                "2", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
                 "2"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", "\"\<\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", "tempanova2"}], ",", 
          RowBox[{"PadRight", "[", 
           RowBox[{"posthoc", ",", 
            RowBox[{"Length", "@", "tempmsd"}], ",", "\"\<\>\""}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworryanova", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "datayy_", ",", "factornumx_", ",", 
      "factornumm_", ",", "factornumy_", ",", "varstringx_", ",", 
      "varstringm_", ",", "varstringy_", ",", "norminalvariableso_", ",", 
      "norminalstrings_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "datax", ",", "datam", ",", "datay", ",", "cronbach", ",", "numfx", 
        ",", "numfm", ",", "numfy", ",", "seqx", ",", "seqm", ",", "seqy", 
        ",", "newdatax", ",", "newdatam", ",", "newdatay", ",", "newdataxmy", 
        ",", "numfn", ",", "dataanova", ",", "norminalvariables", ",", 
        "norminalvariablesnum", ",", "norminalvariablepos"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"datax", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"dataxx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "dataxx", ",", 
          RowBox[{"dataxx", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datam", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"datamm", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "datamm", ",", 
          RowBox[{"datamm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datay", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"datayy", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "datayy", ",", 
          RowBox[{"datayy", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numfx", "=", 
        RowBox[{"Length", "@", "factornumx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumx"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatax", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", "Mean"}], "/@", 
             RowBox[{"datax", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
           "seqx"}], ",", 
          RowBox[{"Mean", "/@", "dataxx"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfm", "=", 
        RowBox[{"Length", "@", "factornumm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqm", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumm"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatam", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mean", "/@", 
             RowBox[{"datam", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
           "seqm"}], ",", 
          RowBox[{"Mean", "/@", "datamm"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfy", "=", 
        RowBox[{"Length", "@", "factornumy"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqy", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumy"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatay", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mean", "/@", 
             RowBox[{"datay", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
           "seqy"}], ",", 
          RowBox[{"Mean", "/@", "datayy"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdataxmy", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newdatax", ",", "newdatam", ",", "newdatay"}], "}"}], ",",
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfy", "=", 
        RowBox[{"Length", "@", "norminalstrings"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norminalvariables", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"norminalvariableso", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
          "norminalvariableso", ",", "norminalvariableso"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataanova", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", "norminalvariables", "]"}], ",", 
          "newdataxmy"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dataanova", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"myanova", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Transpose", "[", "norminalvariables", "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "newdataxmy"}], "}"}]}], "]"}], ",", "2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"norminalvariablesnum", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Tally", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", "norminalvariables", "]"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dataanova", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "#", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "0.00001"}], ",", "0.00001", ",", "#"}], 
             "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"dataanova", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dataanova", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"PadRight", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"norminalvariablesnum", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], "]"}], 
                "&"}], "/@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringx", ",", "\"\<X\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringm", ",", "\"\<M\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringy", ",", "\"\<Y\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}], "}"}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "norminalvariablesnum"}]}], "}"}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"Transpose", "@", "dataanova"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norminalvariablepos", "=", 
        RowBox[{
         RowBox[{"\"\<\>\"", "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", 
           RowBox[{"dataanova", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norminalvariablepos", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"1", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Accumulate", "[", 
                RowBox[{"norminalvariablesnum", "*", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "varstringx", ",", "varstringm", ",", "varstringy"}], 
                    "}"}], "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], "]"}], "=", 
        "norminalstrings"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"10", ",", "3"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"Transpose", "@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "norminalvariablepos", "}"}], ",", 
               RowBox[{"N", "@", "dataanova"}]}], "]"}]}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\:4eba\:53e3\:7d71\:8a08\:8b8a\:6578\>\"", ",", 
            "\"\<\:56e0\:7d20\>\"", ",", "\"\<\:7d44\:5225\>\"", ",", 
            "\"\<\:5e73\:5747\:6578\>\"", ",", "\"\<\:6a19\:6e96\:5dee\>\"", 
            ",", "\"\<F\:503c\>\"", ",", "\"\<P \:503c\>\"", ",", 
            "\"\<\:4e8b\:5f8c\:6bd4\:8f03\>\""}], "}"}], ",", "1"}], "]"}], "//",
         "TableForm"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ItemAnalysisBackup", "[", "data_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"varname", ",", 
        RowBox[{"mydata", "=", "data"}], ",", "sum", ",", "lower", ",", 
        "upper", ",", "testdata", ",", "testdatalow", ",", "testdatahigh", 
        ",", "itemdata"}], "}"}], ",", 
      RowBox[{
       RowBox[{"varname", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<V\>\"", "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "9"}], ",", 
             RowBox[{"\"\<0\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], ",", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", 
           RowBox[{"mydata", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"Total", "[", "#", "]"}]}], "}"}]}], "&"}], "/@", 
         "mydata"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lower", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"sum", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.27"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"upper", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"sum", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.73"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sum", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sum", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "\[GreaterEqual]", 
               "upper"}], ",", "2", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sum", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "\[LessEqual]", 
                 "lower"}], ",", "1", ",", "0"}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", "sum"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{"GatherBy", "[", 
         RowBox[{"testdata", ",", "Last"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdatalow", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"testdata", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "1"}], "}"}], ",", "Infinity"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdatahigh", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"testdata", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "2"}], "}"}], ",", "Infinity"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itemdata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varname", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               "\"\<\:4f4e\:5206\:7d44\>\"", ",", 
               RowBox[{"Length", "@", 
                RowBox[{"testdatalow", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "#"}], "]"}], "]"}]}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"Mean", "@", 
                   RowBox[{"testdatalow", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"StandardDeviation", "@", 
                   RowBox[{"testdatalow", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", "0.00001"}], ",", 
                    "0", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "4"}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"TTest", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"testdatalow", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"testdatahigh", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}], "}"}], ",", 
                    "0", ",", "\"\<TestDataTable\>\"", ",", 
                    RowBox[{
                    "VerifyTestAssumptions", "\[Rule]", 
                    "\"\<EqualVariance\>\""}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "}"}]}], 
               ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"Correlation", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Total", "/@", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\:9ad8\:5206\:7d44\>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"testdatahigh", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "#"}], "]"}], "]"}]}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", 
                 RowBox[{"Mean", "@", 
                  RowBox[{"testdatahigh", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", 
                 RowBox[{"StandardDeviation", "@", 
                  RowBox[{"testdatahigh", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", "\"\<\>\"", 
              ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", "varname"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"itemdata", ",", "1"}], "]"}], ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\:984c\:9805\>\"", ",", "\"\<\:7d44\:5225\>\"", ",", 
              "\"\<\:500b\:6578\>\"", ",", "\"\<\:5e73\:5747\:6578\>\"", ",", 
              "\"\<\:6a19\:6e96\:5dee\>\"", ",", "\"\<CR\>\"", ",", 
              "\"\<P-Value\>\"", ",", 
              "\"\<\:8207\:7e3d\:5206\:76f8\:95dc\:4fc2\:6578\>\""}], "}"}]}],
            "}"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ItemAnalysis", "[", 
     RowBox[{"data_", ",", "factornum_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"varname", ",", 
        RowBox[{"mydata", "=", "data"}], ",", "sum", ",", "lower", ",", 
        "upper", ",", "testdata", ",", "testdatalow", ",", "testdatahigh", 
        ",", "itemdata", ",", "itemcor"}], "}"}], ",", 
      RowBox[{
       RowBox[{"varname", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<V\>\"", "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "9"}], ",", 
             RowBox[{"\"\<0\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], ",", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", 
           RowBox[{"mydata", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"Total", "[", "#", "]"}]}], "}"}]}], "&"}], "/@", 
         "mydata"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lower", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"sum", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.27"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"upper", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"sum", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "0.73"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sum", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sum", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "\[GreaterEqual]", 
               "upper"}], ",", "2", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sum", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "\[LessEqual]", 
                 "lower"}], ",", "1", ",", "0"}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", "sum"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{"GatherBy", "[", 
         RowBox[{"testdata", ",", "Last"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdatalow", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"testdata", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "1"}], "}"}], ",", "Infinity"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testdatahigh", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"testdata", ",", 
           RowBox[{"{", 
            RowBox[{"a_", ",", "2"}], "}"}], ",", "Infinity"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itemcor", "=", 
        RowBox[{"ItemAnalysisCor", "[", 
         RowBox[{"data", ",", "factornum"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itemdata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"varname", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               "\"\<\:4f4e\:5206\:7d44\>\"", ",", 
               RowBox[{"Length", "@", 
                RowBox[{"testdatalow", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "#"}], "]"}], "]"}]}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"Mean", "@", 
                   RowBox[{"testdatalow", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"StandardDeviation", "@", 
                   RowBox[{"testdatalow", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "<", "0.00001"}], ",", 
                    "0.0001", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "4"}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"TTest", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"testdatalow", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"testdatahigh", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}], "}"}], ",", 
                    "0", ",", "\"\<TestDataTable\>\"", ",", 
                    RowBox[{
                    "VerifyTestAssumptions", "\[Rule]", 
                    "\"\<EqualVariance\>\""}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "}"}]}], 
               ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"itemcor", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "#"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"itemcor", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "#"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", 
                  RowBox[{"Correlation", "[", 
                   RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"Total", "/@", "data"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\:9ad8\:5206\:7d44\>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"testdatahigh", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "#"}], "]"}], "]"}]}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", 
                 RowBox[{"Mean", "@", 
                  RowBox[{"testdatahigh", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", 
                 RowBox[{"StandardDeviation", "@", 
                  RowBox[{"testdatahigh", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4"}], "}"}]}], "]"}], ",", "\"\<\>\"", 
              ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", "varname"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"itemdata", ",", "1"}], "]"}], ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\:984c\:9805\>\"", ",", "\"\<\:7d44\:5225\>\"", ",", 
              "\"\<\:500b\:6578\>\"", ",", "\"\<\:5e73\:5747\:6578\>\"", ",", 
              "\"\<\:6a19\:6e96\:5dee\>\"", ",", "\"\<CR\>\"", ",", 
              "\"\<P-Vale\>\"", ",", 
              "\"\<\:8207\:5206\:91cf\:8868\:7e3d\:5206\:76f8\:95dc\:4fc2\
\:6578\>\"", ",", 
              "\"\<\:8207\:975e\:8a72\:984c\:9805\:7e3d\:5206\:76f8\:95dc\
\:4fc2\:6578\>\"", ",", 
              "\"\<\:8207\:7e3d\:5206\:76f8\:95dc\:4fc2\:6578\>\""}], "}"}]}],
            "}"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ItemAnalysisCor", "[", 
     RowBox[{"data_", ",", "factornum_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numx", ",", "numf", ",", "seq", ",", "newdata"}], "}"}], ",", 
      
      RowBox[{
       RowBox[{"numx", "=", 
        RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numf", "=", 
        RowBox[{"Length", "@", "factornum"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seq", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornum"}], "}"}]}], "]"}], ",", "2", ",", 
           "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}], "&"}], "/@", 
         "seq"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdata", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"Total", "[", "#", "]"}]}], "}"}]}], "&"}], ",", 
          "newdata", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"N", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Correlation", "[", 
              RowBox[{
               RowBox[{"newdata", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "All", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"newdata", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "All", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "factornum"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"factornum", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", "Correlation"}], "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"Total", "/@", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Total", "@", "factornum"}], "]"}], ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], "]"}]}]}], 
              "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Total", "@", "factornum"}]}], "}"}]}], "]"}]}]}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworrysem", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "datayy_", ",", "factornumx_", ",", 
      "factornumm_", ",", "factornumy_", ",", "varstringx_", ",", 
      "varstringm_", ",", "varstringy_", ",", "semmicode_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "test", ",", "test1", ",", "test2", ",", "test3", ",", "semdmodel", 
        ",", "cfi", ",", "chi", ",", "df", ",", "chipv", ",", "rmsea", ",", 
        "xxrange", ",", "mmrange", ",", "yyrange", ",", "xloading", ",", 
        "mloading", ",", "yloading", ",", "XX", ",", "YY", ",", "MM", ",", 
        "regcoef", ",", "loadings", ",", "myreport", ",", "semdmodel2", ",", 
        "nnfi", ",", "gfi", ",", "agfi"}], "}"}], ",", 
      RowBox[{
       RowBox[{"test1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"dataxx", "[", 
               RowBox[{"[", 
                RowBox[{"z", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Accumulate", "@", "factornumx"}]}], ",", 
                   RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "2", ",", 
                 "1"}], "]"}]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"Length", "@", "dataxx"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"test2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"datamm", "[", 
               RowBox[{"[", 
                RowBox[{"z", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Accumulate", "@", "factornumm"}]}], ",", 
                   RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "2", ",", 
                 "1"}], "]"}]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"Length", "@", "datamm"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"test3", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"datayy", "[", 
               RowBox[{"[", 
                RowBox[{"z", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Accumulate", "@", "factornumy"}]}], ",", 
                   RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "2", ",", 
                 "1"}], "]"}]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"Length", "@", "datayy"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"test", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Flatten", "/@", 
           RowBox[{"N", "@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{"test1", ",", "test2", ",", "test3"}], "}"}]}]}]}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"varstringx", ",", "varstringm", ",", "varstringy"}], 
            "}"}]}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<test.csv\>\"", ",", "test"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:5404\:6982\:5ff5\:5e73\:5747\:6578\:53ca\:6a19\:6e96\:5dee\\n\>\
\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "z"}], "]"}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"Mean", "[", 
                  RowBox[{
                   RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "3"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"StandardDeviation", "[", 
                  RowBox[{
                   RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\:6982\:5ff5\>\"", ",", "\"\<\:5e73\:5747\:6578\>\"", ",", 
             "\"\<\:6a19\:6e96\:5dee\>\""}], "}"}], ",", "1"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"semdmodel", "=", 
        RowBox[{"REvaluate", "[", 
         RowBox[{"\"\<{\n      \tda=data.frame(read.csv(\\\"\>\"", "<>", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"\"\<\\\\\>\"", "\[Rule]", "\"\<\\\\\\\\\>\""}]}], "]"}], 
          "<>", "\"\<test.csv\\\", header=T, sep=\\\",\\\"))\n      \t\
model<-'\n      \t# measurement model\n      \t\tXX=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringx", "]"}]}], "<>", 
          "\"\<\n      \t\tMM=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringm", "]"}]}], "<>", 
          "\"\<\n      \t\tYY=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringy", "]"}]}], "<>", "\"\<\\n\>\"", "<>",
           "semmicode", "<>", "\"\<\\n\>\"", "<>", 
          
          "\"\<\n      \t# regressions\n      \t\tMM~ XX\n      \t\tYY~MM+ XX\
\n      \t'\n      \tfit <- sem(model, data=da, estimator=\\\"\>\"", "<>", 
          "semmethod", "<>", 
          "\"\<\\\")\n      \tcapture.output(print(summary(fit, \
fit.measures=TRUE, standardized=TRUE)))\n      \t}\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$sem", "=", "semdmodel"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"semdmodel2", "=", 
          RowBox[{"REvaluate", "[", "\"\< fitMeasures(fit)\>\"", "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
            "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
          RowBox[{
           RowBox[{"semdmodel2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{
             "3", ",", "4", ",", "5", ",", "9", ",", "11", ",", "23", ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "4"}]}], "}"}], "]"}], "]"}]}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
          "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          "\"\<fitMeasures(fit,c(\\\"chisq\\\",\\\"df\\\",\\\"pvalue\\\",\\\"\
cfi\\\",\\\"nfi\\\",\\\"rmsea\\\",\\\"gfi\\\",\\\"agfi\\\"))\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$semmi", "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          "\"\<{\n      \tmi <- modindices(fit)\n      \tmi[mi$op == \\\"~~\\\
\",]\n      \tsubset(mi[mi$op == \\\"~~\\\",], mi > 5)\n      \t}\>\"", "]"}],
          "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\\n\>\""}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\:5361\:65b9\:503c\>\"", ",", "\"\<\:81ea\:7531\:5ea6\>\"",
                ",", "\"\<P-value\>\"", ",", 
               "\"\<\:5361\:65b9\:503c/\:81ea\:7531\:5ea6\>\"", ",", 
               "\"\<CFI\>\"", ",", "\"\<NFI\>\"", ",", "\"\<RMSEA\>\"", ",", 
               "\"\<GFI\>\"", ",", "\"\<AGFI\>\""}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NumberForm", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"8", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"chi", ",", "df", ",", "chipv", ",", 
                RowBox[{"chi", "/", "df"}], ",", "cfi", ",", "nnfi", ",", 
                "rmsea", ",", "gfi", ",", "agfi"}], "}"}]}]}], "}"}]}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\:6307\:6a19\>\"", ",", 
               "\"\<\>\""}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6Modification \
Indices\:503c\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "$semmi", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"xxrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<XX\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mmrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<MM\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yyrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<YY\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xxrange", "=", 
        RowBox[{
         RowBox[{"xxrange", "+", "1"}], ";;", 
         RowBox[{"xxrange", "+", 
          RowBox[{"Length", "@", "factornumx"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mmrange", "=", 
        RowBox[{
         RowBox[{"mmrange", "+", "1"}], ";;", 
         RowBox[{"mmrange", "+", 
          RowBox[{"Length", "@", "factornumm"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yyrange", "=", 
        RowBox[{
         RowBox[{"yyrange", "+", "1"}], ";;", 
         RowBox[{"yyrange", "+", 
          RowBox[{"Length", "@", "factornumy"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"XX", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "xxrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MM", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "mmrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"YY", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "yyrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xloading", ",", "mloading", ",", "yloading"}], "}"}], ",",
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"regcoef", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<MM ~\>\""}], "]"}], "&"}], "/@", 
               "semdmodel"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<YY ~\>\""}], "]"}], "&"}], "/@", 
               "semdmodel"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<YY ~\>\""}], "]"}], "&"}], "/@", 
               "semdmodel"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "2"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"regcoef", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"regcoef", "+", "2"}], ",", 
            RowBox[{"regcoef", "+", "4"}], ",", 
            RowBox[{"regcoef", "+", "5"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "@", 
            RowBox[{"Select", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[NotEqual]", "\"\<\>\""}], "&"}], ",", 
              "Infinity"}], "]"}]}], "&"}], "/@", 
          RowBox[{"StringSplit", "[", 
           RowBox[{
            RowBox[{"semdmodel", "[", 
             RowBox[{"[", "regcoef", "]"}], "]"}], ",", "\"\< \>\""}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"regcoef", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[NotEqual]", "\"\<\>\""}], "&"}], ",", 
             "Infinity"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "3"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "regcoef", "]"}], "]"}], ",", "\"\< \>\""}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"regcoef", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"regcoef", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[Rule]", "MM"}], 
            ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"regcoef", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"regcoef", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"regcoef", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "\[Rule]", "YY"}], 
            ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"regcoef", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"regcoef", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"regcoef", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "\[Rule]", "YY"}], 
            ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"regcoef", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"regcoef", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"loadings", ",", "regcoef"}], "}"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:6e2c\:91cf\:6a21\:5f0f\:8207\:7d50\:69cb\:6a21\:5f0f\:6aa2\
\:5b9a\:5f59\:6574\:8868\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"Insert", "[", 
          RowBox[{"myreport", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\:8def\:5f91\>\"", ",", 
             "\"\<\:6a19\:6e96\:5316\:8def\:5f91\:4fc2\:6578\>\"", ",", 
             "\"\<P-value\>\""}], "}"}], ",", "1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\\n\:7814\:7a76\:67b6\:69cb\:8def\:5f91\:5716\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"XX", "\[Rule]", "#"}], "&"}], "/@", 
               RowBox[{"ToExpression", "@", "varstringx"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"MM", "\[Rule]", "#"}], "&"}], "/@", "varstringm"}], 
              ",", 
              RowBox[{
               RowBox[{
                RowBox[{"YY", "\[Rule]", "#"}], "&"}], "/@", "varstringy"}], 
              ",", 
              RowBox[{"XX", "\[Rule]", "MM"}], ",", 
              RowBox[{"MM", "\[Rule]", "YY"}], ",", 
              RowBox[{"XX", "\[Rule]", "YY"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"VertexSize", "\[Rule]", "0.5"}], ",", 
          RowBox[{"VertexShapeFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ToExpression", "[", "#", "]"}], "\[Rule]", 
                  "\"\<Rectangle\>\""}], "&"}], "/@", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "varstringx", ",", "varstringm", ",", "varstringy"}], "}"}],
                  "]"}]}], ",", 
               RowBox[{"XX", "\[Rule]", "\"\<Circle\>\""}], ",", 
               RowBox[{"MM", "\[Rule]", "\"\<Circle\>\""}], ",", 
               RowBox[{"YY", "\[Rule]", "\"\<Circle\>\""}]}], "}"}]}], 
            ")"}]}], ",", 
          RowBox[{"GraphLayout", "\[Rule]", "\"\<SpringEmbedding\>\""}], ",", 
          
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"i", ",", "Center"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", 
                 RowBox[{
                 "XX", ",", "YY", ",", "MM", ",", "varstringx", ",", 
                  "varstringm", ",", "varstringy"}], "}"}]}]}], "}"}]}], 
            "]"}]}], ",", 
          RowBox[{"EdgeLabels", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}], "\[Rule]", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
             RowBox[{"myreport", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ")"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"myreport", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                RowBox[{"Rule", "[", 
                 RowBox[{"XX", ",", "YY"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "<", "0.05"}], ",", 
         RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "\:5b8c\:5168\:4e2d\:4ecb\:6a21\:578b", "*)"}], 
       RowBox[{
       "Print", "@", 
        "\"\<XX->YY \:4e0d\:986f\:8457\:ff0c\:4ee5\:4e0b\:70ba\:5b8c\:5168\
\:4e2d\:4ecb\:6a21\:578b\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"semdmodel", "=", 
        RowBox[{"REvaluate", "[", 
         RowBox[{"\"\<{\n      \tda=data.frame(read.csv(\\\"\>\"", "<>", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"\"\<\\\\\>\"", "\[Rule]", "\"\<\\\\\\\\\>\""}]}], "]"}], 
          "<>", "\"\<test.csv\\\", header=T, sep=\\\",\\\"))\n      \t\
model<-'\n      \t# measurement model\n      \t\tXX=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringx", "]"}]}], "<>", 
          "\"\<\n      \t\tMM=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringm", "]"}]}], "<>", 
          "\"\<\n      \t\tYY=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringy", "]"}]}], "<>", "\"\<\\n\>\"", "<>",
           "semmicode", "<>", "\"\<\\n\>\"", "<>", 
          "\"\<\n      \t# regressions\n      \t\tMM~XX\n      \t\tYY~MM\n    \
  \t'\n      \tfit <- sem(model, data=da, estimator=\\\"\>\"", "<>", 
          "semmethod", "<>", 
          "\"\<\\\")\n      \tcapture.output(print(summary(fit, \
fit.measures=TRUE, standardized=TRUE)))\n      \t}\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$semc", "=", "semdmodel"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"semdmodel2", "=", 
          RowBox[{"REvaluate", "[", "\"\< fitMeasures(fit)\>\"", "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
            "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
          RowBox[{
           RowBox[{"semdmodel2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{
             "3", ",", "4", ",", "5", ",", "9", ",", "11", ",", "23", ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "4"}]}], "}"}], "]"}], "]"}]}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
          "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          "\"\<fitMeasures(fit,c(\\\"chisq\\\",\\\"df\\\",\\\"pvalue\\\",\\\"\
cfi\\\",\\\"nfi\\\",\\\"rmsea\\\",\\\"gfi\\\",\\\"agfi\\\"))\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$semmi", "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          
          "\"\<{\n      \tmi <- modindices(fit)\n      \tmi[mi$op == \\\"~~\\\
\",]\n      \tsubset(mi[mi$op == \\\"~~\\\",], mi > 5)\n      \t}\>\"", "]"}],
          "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\\n\>\""}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\:5361\:65b9\:503c\>\"", ",", "\"\<\:81ea\:7531\:5ea6\>\"",
                ",", "\"\<P-value\>\"", ",", 
               "\"\<\:5361\:65b9\:503c/\:81ea\:7531\:5ea6\>\"", ",", 
               "\"\<CFI\>\"", ",", "\"\<NFI\>\"", ",", "\"\<RMSEA\>\"", ",", 
               "\"\<GFI\>\"", ",", "\"\<AGFI\>\""}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NumberForm", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"8", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"chi", ",", "df", ",", "chipv", ",", 
                RowBox[{"chi", "/", "df"}], ",", "cfi", ",", "nnfi", ",", 
                "rmsea", ",", "gfi", ",", "agfi"}], "}"}]}]}], "}"}]}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\:6307\:6a19\>\"", ",", 
               "\"\<\>\""}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6Modification \
Indices\:503c\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "$semmi", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"xxrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<XX\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mmrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<MM\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yyrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<YY\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xxrange", "=", 
        RowBox[{
         RowBox[{"xxrange", "+", "1"}], ";;", 
         RowBox[{"xxrange", "+", 
          RowBox[{"Length", "@", "factornumx"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mmrange", "=", 
        RowBox[{
         RowBox[{"mmrange", "+", "1"}], ";;", 
         RowBox[{"mmrange", "+", 
          RowBox[{"Length", "@", "factornumm"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yyrange", "=", 
        RowBox[{
         RowBox[{"yyrange", "+", "1"}], ";;", 
         RowBox[{"yyrange", "+", 
          RowBox[{"Length", "@", "factornumy"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"XX", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "xxrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MM", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "mmrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"YY", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "yyrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xloading", ",", "mloading", ",", "yloading"}], "}"}], ",",
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"regcoef", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<MM ~\>\""}], "]"}], "&"}], "/@", 
               "semdmodel"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<YY ~\>\""}], "]"}], "&"}], "/@", 
               "semdmodel"}], ",", "True"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"regcoef", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"regcoef", "+", "2"}], ",", 
            RowBox[{"regcoef", "+", "4"}], ",", 
            RowBox[{"regcoef", "+", "5"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "@", 
            RowBox[{"Select", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[NotEqual]", "\"\<\>\""}], "&"}], ",", 
              "Infinity"}], "]"}]}], "&"}], "/@", 
          RowBox[{"StringSplit", "[", 
           RowBox[{
            RowBox[{"semdmodel", "[", 
             RowBox[{"[", "regcoef", "]"}], "]"}], ",", "\"\< \>\""}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"regcoef", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[NotEqual]", "\"\<\>\""}], "&"}], ",", 
             "Infinity"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "3"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "regcoef", "]"}], "]"}], ",", "\"\< \>\""}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"regcoef", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"regcoef", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[Rule]", "MM"}], 
            ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"regcoef", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"regcoef", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"regcoef", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "\[Rule]", "YY"}], 
            ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"regcoef", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
            RowBox[{"regcoef", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"loadings", ",", "regcoef"}], "}"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
         "myreport"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:6e2c\:91cf\:6a21\:5f0f\:8207\:7d50\:69cb\:6a21\:5f0f\:6aa2\
\:5b9a\:5f59\:6574\:8868\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"Insert", "[", 
          RowBox[{"myreport", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\:8def\:5f91\>\"", ",", 
             "\"\<\:6a19\:6e96\:5316\:8def\:5f91\:4fc2\:6578\>\"", ",", 
             "\"\<P-value\>\""}], "}"}], ",", "1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\\n\:7814\:7a76\:67b6\:69cb\:8def\:5f91\:5716\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"XX", "\[Rule]", "#"}], "&"}], "/@", 
              RowBox[{"ToExpression", "@", "varstringx"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"MM", "\[Rule]", "#"}], "&"}], "/@", "varstringm"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"YY", "\[Rule]", "#"}], "&"}], "/@", "varstringy"}], 
             ",", 
             RowBox[{"XX", "\[Rule]", "MM"}], ",", 
             RowBox[{"MM", "\[Rule]", "YY"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.5"}], ",", 
         RowBox[{"VertexShapeFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ToExpression", "[", "#", "]"}], "\[Rule]", 
                 "\"\<Rectangle\>\""}], "&"}], "/@", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"varstringx", ",", "varstringm", ",", "varstringy"}],
                  "}"}], "]"}]}], ",", 
              RowBox[{"XX", "\[Rule]", "\"\<Circle\>\""}], ",", 
              RowBox[{"MM", "\[Rule]", "\"\<Circle\>\""}], ",", 
              RowBox[{"YY", "\[Rule]", "\"\<Circle\>\""}]}], "}"}]}], ")"}]}],
          ",", 
         RowBox[{"GraphLayout", "\[Rule]", "\"\<SpringEmbedding\>\""}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"Placed", "[", 
              RowBox[{"i", ",", "Center"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Flatten", "@", 
               RowBox[{"{", 
                RowBox[{
                "XX", ",", "YY", ",", "MM", ",", "varstringx", ",", 
                 "varstringm", ",", "varstringy"}], "}"}]}]}], "}"}]}], 
           "]"}]}], ",", 
         RowBox[{"EdgeLabels", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}], "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
            RowBox[{"myreport", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ")"}]}]}], 
        "]"}]}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworrycfa", "[", 
     RowBox[{"dataxx_", ",", "factornumx_", ",", "varstringx_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "var", ",", "test", ",", "out", ",", "cfa", ",", "cfamodel", ",", 
        "cfi", ",", "chi", ",", "df", ",", "chipv", ",", "rmsea", ",", 
        "myreport", ",", "loadings", ",", "ave", ",", "cr", ",", "dis", ",", 
        "cfamodel2", ",", "nnfi", ",", "gfi", ",", "agfi"}], "}"}], ",", 
      RowBox[{
       RowBox[{"var", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Insert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Range", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"Accumulate", "@", "factornumx"}]}], ",", 
             RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "2", ",", "1"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"test", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"dataxx", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<V\>\"", "<>", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", "\[LessEqual]", "9"}], ",", 
               RowBox[{"\"\<0\>\"", "<>", 
                RowBox[{"ToString", "[", "#", "]"}]}], ",", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Total", "@", "factornumx"}], "]"}]}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<test.csv\>\"", ",", "test"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cfa", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"test", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "&"}], "/@", "var"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"cfa", "=", 
        RowBox[{"\"\<cfamodel<-'\\n\>\"", "<>", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"varstringx", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "<>", "\"\<=~ \>\"", "<>", 
             RowBox[{"cfa", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "<>", "\"\<\\n\>\""}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "cfa"}], "]"}]}], "]"}], "<>", 
         "\"\<'\\n\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cfa", "=", 
        RowBox[{
        "cfa", "<>", "\"\<fit <- cfa(cfamodel, data=test, estimator=\\\"\>\"",
          "<>", "semmethod", "<>", "\"\<\\\")\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cfa", "=", 
        RowBox[{"\"\<{test=data.frame(read.csv(\\\"\>\"", "<>", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           RowBox[{"\"\<\\\\\>\"", "\[Rule]", "\"\<\\\\\\\\\>\""}]}], "]"}], 
         "<>", "\"\<test.csv\\\", header=T, sep=\\\",\\\"))\\n\>\"", "<>", 
         "cfa", "<>", 
         "\"\<\\n capture.output(print(summary(fit, fit.measures=TRUE, \
standardized=TRUE)))\>\"", "<>", "\"\<}\>\""}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"$cfar", "=", "cfa"}], ";", "\[IndentingNewLine]", 
       RowBox[{"cfamodel", "=", 
        RowBox[{"REvaluate", "[", "cfa", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"cfamodel2", "=", 
          RowBox[{"REvaluate", "[", "\"\< fitMeasures(fit)\>\"", "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
            "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
          RowBox[{
           RowBox[{"cfamodel2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{
             "3", ",", "4", ",", "5", ",", "9", ",", "11", ",", "23", ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "4"}]}], "}"}], "]"}], "]"}]}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
          "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          "\"\<fitMeasures(fit,c(\\\"chisq\\\",\\\"df\\\",\\\"pvalue\\\",\\\"\
cfi\\\",\\\"nfi\\\",\\\"rmsea\\\",\\\"gfi\\\",\\\"agfi\\\"))\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$cfa", "=", 
        RowBox[{"Column", "@", "cfamodel"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\:5361\:65b9\:503c\>\"", ",", "\"\<\:81ea\:7531\:5ea6\>\"",
                ",", "\"\<P-value\>\"", ",", 
               "\"\<\:5361\:65b9\:503c/\:81ea\:7531\:5ea6\>\"", ",", 
               "\"\<CFI\>\"", ",", "\"\<NFI\>\"", ",", "\"\<RMSEA\>\"", ",", 
               "\"\<GFI\>\"", ",", "\"\<AGFI\>\""}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                   "0", ",", "#"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"8", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"chi", ",", "df", ",", "chipv", ",", 
                RowBox[{"chi", "/", "df"}], ",", "cfi", ",", "nnfi", ",", 
                "rmsea", ",", "gfi", ",", "agfi"}], "}"}]}]}], "}"}]}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\:6307\:6a19\>\"", ",", 
               "\"\<\>\""}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"cfamodel", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", "\"\<Latent\>\""}], "]"}], "&"}], "/@", 
                "cfamodel"}], ",", "True"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "2"}], ";;", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "factornumx", "]"}], "\[Equal]", 
                    "1"}], ",", "\"\<Variances:\>\"", ",", 
                    "\"\<Covariances:\>\""}], "]"}]}], "]"}], "&"}], "/@", 
                "cfamodel"}], ",", "True"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "2"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{"ToExpression", "@", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
             "myreport"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "#"}], "\[GreaterEqual]", "3"}], "&"}]}],
            "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "9"}]}], "}"}]}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ave", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"loadings", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "^", "2"}], ")"}], 
             "[", 
             RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "&"}], "/@", "var"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"cr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"loadings", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "^", "2"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"loadings", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], "^", "2"}], "+", 
             RowBox[{"Total", "[", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"loadings", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "^", "2"}]}], "]"}]}], 
            ")"}]}], "&"}], "/@", "var"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$avecr", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{"ave", ",", "cr"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "\"\<\>\""}], 
              ",", "\"\<\>\"", ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
            "\"\<\>\"", ",", "\"\<\>\""}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"loadings", "/.", 
           RowBox[{"Null", "\[Rule]", "\"\<\>\""}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myreport", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "4"}], "]"}], 
         "]"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumberForm", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "&"}], ",", "ave"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myreport", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], 
         "]"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumberForm", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "&"}], ",", "cr"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$mycfareport", "=", "myreport"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"$mycfareport", "=", 
        RowBox[{
        "\"\<\:6536\:6582\:6548\:5ea6\:8207\:5340\:5225\:6548\:5ea6\:5408\
\:7a31\:70ba\:5efa\:69cb\:6548\:5ea6\:ff0c\:662f\:8861\:91cf\:6a21\:578b\:5167\
\:5728\:54c1\:8cea\:7684\:91cd\:8981\:6307\:6a19(\:9673\:5bec\:88d5\:3001\
\:738b\:632f\:83ef\:ff0c2010)\:3002\:7531\:8868 X \:53ef\:767c\:73fe\:ff0c\
\:6240\:6709\:7814\:7a76\:8b8a\:6578\:7684\:56e0\:7d20\:8ca0\:8377\:91cf\:5747\
\:5927\:65bc\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Min", "@", 
           RowBox[{"$mycfareport", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "<>", 
         "\"\<\:ff1a\:800c\:7d44\:5408\:4fe1\:5ea6\:503c\:4e5f\:7686\:5927\
\:65bc\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Min", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"$mycfareport", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "5"}], "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"NumberForm", "[", 
                RowBox[{"x_", ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "\[RuleDelayed]", 
               "x"}]}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "<>", 
         "\"\<\:ff1b\:5e73\:5747\:8b8a\:7570\:62bd\:53d6\:91cf\:5747\:5927\
\:65bc\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Min", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"$mycfareport", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "4"}], "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"NumberForm", "[", 
                RowBox[{"x_", ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "\[RuleDelayed]", 
               "x"}]}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "<>", 
         "\"\<\:ff1b\:9054\:5230 Fornell \:8207 Larcker(1981)\:5efa\:8b70\
\:4e4b\:6a19\:6e96\:503c\:ff0c\:8868\:793a\:5177\:6709\:826f\:597d\:7684\:6536\
\:6582\:6548\:5ea6\:3002\:5f9e\:8868 X \:53ef\:770b\:51fa\:5404\:69cb\:9762\
\:4e4b AVE \:7684\:5e73\:65b9\:6839\:4ecb\:65bc \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Min", "@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"$mycfareport", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "4"}], "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"x_", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "\[RuleDelayed]",
                  "x"}]}], ",", 
               RowBox[{
                RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], ")"}], "^", 
           "0.5"}], "]"}], "<>", "\"\<~\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Max", "@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"$mycfareport", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "4"}], "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"x_", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}], "\[RuleDelayed]",
                  "x"}]}], ",", 
               RowBox[{
                RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], ")"}], "^", 
           "0.5"}], "]"}], "<>", 
         "\"\<\:ff0c\:5747\:5927\:65bc\:5404\:69cb\:9762\:9593\:7684\:76f8\
\:95dc\:4fc2\:6578\:ff0c\:6b64\:5206\:6790\:7d50\:679c\:986f\:793a\:5404\:69cb\
\:9762\:7686\:6eff\:8db3\:5224\:65b7\:6a19\:6e96\:ff0c\:986f\:793a\:91cf\:8868\
\:5177\:6709\:5340\:5225\:6548\:5ea6\:3002\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:805a\:5408\:6548\:5ea6 (AVE) \:8207\:6536\:6582\:4fe1\:5ea6 \
(CR)\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"myreport", "/.", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "$myfactorrule", "]"}], "==", "0"}], ",", 
             RowBox[{"{", "}"}], ",", "$myfactorrule"}], "]"}]}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:984c\:9805\>\"", ",", "\"\<\:56e0\:7d20\:8ca0\:8377\>\"",
                ",", "\"\<P-value\>\"", ",", "\"\<AVE\>\"", ",", 
               "\"\<CR\>\""}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"test", "=", 
        RowBox[{"test", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dis", "=", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Correlation", "[", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Mean", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"test", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
               "var"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\:5340\:9694\:6548\:5ea6\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"j", "\[Equal]", "i"}], ",", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ave", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "0.5"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "3"}], "}"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", ">", "i"}], ",", "\"\<\>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"dis", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "varstringx"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "@", "varstringx"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"varstringx", ",", "varstringx"}], "}"}]}]}], "]"}]}]}]}],
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "$mynote", "=", 
    "\"\<\:6240\:6709\:5831\:8868\:8acb\:9078\:53d6\:5f8c\:6309\:6ed1\:9f20\
\:53f3\:9375->\:9078\:64c7Copy As Plain \
Text->\:958b\:555fExcel\:8cbc\:4e0a\\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThesisNoWorryMed", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "datayy_", ",", "factornumx_", ",", 
      "factornumm_", ",", "factornumy_", ",", "varstringx_", ",", 
      "varstringm_", ",", "varstringy_", ",", "norminalvariableso_", ",", 
      "norminalstrings_", ",", "semmicode_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "cronbach", "}"}], ",", 
      RowBox[{
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"$mynote", ",", 
          RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\:6b21\:6578\:5206\:914d\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"PadLeft", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Dem", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}], "]"}]}], "*", 
                    "100"}], "//", "N"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
                    "\"\<%\>\""}]}], "}"}], ",", "3", ",", "\"\<\>\""}], 
                    "]"}]}], "&"}], "/@", 
                 RowBox[{"SortBy", "[", 
                  RowBox[{
                   RowBox[{"Tally", "@", 
                    RowBox[{"Dem", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}]}], ",", "First"}],
                   "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"DemName", "[", 
                  RowBox[{"[", "z", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"Length", "@", "DemName"}]}], "}"}]}], "]"}], ",", 
            "1"}], "]"}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:4eba\:53e3\:8b8a\:9805\>\"", ",", "\"\<\:7d44\:5225\>\"",
                ",", "\"\<\:6b21\:6578\>\"", ",", 
               "\"\<\:767e\:5206\:6bd4\>\""}], "}"}]}], "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\:9805\:76ee\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:9805\:76ee\:5206\:6790-X\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"ItemAnalysis", "[", 
         RowBox[{"dataxx", ",", "factornumx"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:9805\:76ee\:5206\:6790-M\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"ItemAnalysis", "[", 
         RowBox[{"datamm", ",", "factornumm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:9805\:76ee\:5206\:6790-Y\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"ItemAnalysis", "[", 
         RowBox[{"datayy", ",", "factornumy"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cronbach", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mycronbach", "[", 
               RowBox[{"dataxx", ",", "factornumx", ",", "varstringx"}], 
               "]"}], ",", 
              RowBox[{"mycronbach", "[", 
               RowBox[{"datamm", ",", "factornumm", ",", "varstringm"}], 
               "]"}], ",", 
              RowBox[{"mycronbach", "[", 
               RowBox[{"datayy", ",", "factornumy", ",", "varstringy"}], 
               "]"}]}], "}"}], ",", "1"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$cronbachtext", "=", "cronbach"}], ";", "\[IndentingNewLine]", 
       RowBox[{"$cronbachtext", "=", 
        RowBox[{
        "\"\<\:4fe1\:5ea6\:5206\:6790\\n \:6b64\:90e8\:5206\:91dd\:5c0d\:7814\
\:7a76\:67b6\:69cb\:4e2d\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Length", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"$cronbachtext", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "<>", 
         "\"\<\:500b\:6f5b\:5728\:8b8a\:9805\:4ee5\:53ca\:5404\:500b\:69cb\
\:9762\:9032\:884c\:4fe1\:5ea6\:7684\:8861\:91cf\:3002\:4e00\:822c Cronbach \
Alpha \:4fc2\:6578\:6700\:597d\:9054\:5230 0.70~0.98 \:4e4b\:9593\:ff0c\:4fbf\
\:53ef\:76f8\:4fe1\:6b64\:91cf\:8868\:69cb\:9762\:4e4b\:554f\:5377\:5177\:6709\
\:826f\:597d\:7684\:4fe1\:5ea6;\:82e5\:662f\:4fe1\:5ea6\:4f4e\:65bc 0.35 \
\:4fbf\:9808\:52a0\:4ee5\:62d2\:7d55\:3002\:672c\:7814\:7a76\:5c07\:4ee5\:6b64\
\:70ba\:5224\:65b7\:6e96\:5247\:ff0c\:5f59\:6574\:7d50\:679c\:5982\:8868 X\
\:ff0c\:7531\:8868 X \:53ef\:77e5\:ff0c\:672c\:7814\:7a76\:6f5b\:5728\:8b8a\
\:9805\:4ee5\:53ca\:5404\:500b\:69cb\:9762\:7684 Cronbach's \[Alpha] \:503c\
\:7686\:5927\:65bc \>\"", " ", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Min", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"$cronbachtext", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "<>", 
         "\"\<\:ff0c\:8868\:793a\:6b64\:554f\:5377\:5177\:6709\:826f\:597d\
\:4fe1\:5ea6\:3002\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"cronbach", "=", 
          RowBox[{"Insert", "[", 
           RowBox[{"cronbach", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\:5404\:5206\:91cf\:8868\>\"", ",", 
              "\"\<Cronbach'\[Alpha]\>\"", ",", 
              "\"\<\:6574\:9ad4\:4fe1\:5ea6\>\""}], "}"}], ",", "1"}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\:4fe1\:5ea6\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{"cronbach", ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:5404\:5206\:91cf\:8868\>\"", ",", 
               "\"\<Cronbach'\[Alpha]\>\"", ",", 
               "\"\<\:6574\:9ad4\:4fe1\:5ea6\>\""}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:4e00\:968eCFA\:6a21\:5f0f\:914d\:9069\:5ea6\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\:4e00\:968eCFA-X\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"thesisnoworrycfa", "[", 
        RowBox[{"dataxx", ",", "factornumx", ",", "varstringx"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$mycfareporttotal", "=", 
        RowBox[{"\"\<\\n\:4e00\:968eCFA-X\\n\>\"", "<>", "$mycfareport"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\:4e00\:968eCFA-M\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"thesisnoworrycfa", "[", 
        RowBox[{"datamm", ",", "factornumm", ",", "varstringm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$mycfareporttotal", "=", 
        RowBox[{
        "$mycfareporttotal", "<>", "\"\<\\n\:4e00\:968eCFA-M\\n\>\"", "<>", 
         "$mycfareport"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\:4e00\:968eCFA-Y\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"thesisnoworrycfa", "[", 
        RowBox[{"datayy", ",", "factornumy", ",", "varstringy"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$mycfareporttotal", "=", 
        RowBox[{
        "$mycfareporttotal", "<>", "\"\<\\n\:4e00\:968eCFA-Y\\n\>\"", "<>", 
         "$mycfareport"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\:8b8a\:7570\:6578\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Quiet", "@", 
         RowBox[{"thesisnoworryanova", "[", 
          RowBox[{
          "dataxx", ",", "datamm", ",", "datayy", ",", "factornumx", ",", 
           "factornumm", ",", "factornumy", ",", "varstringx", ",", 
           "varstringm", ",", "varstringy", ",", "norminalvariableso", ",", 
           "norminalstrings"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\:968e\:5c64\:56de\:6b78\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Quiet", "@", 
         RowBox[{"thesisnoworryhlm", "[", 
          RowBox[{
          "dataxx", ",", "datamm", ",", "datayy", ",", "factornumx", ",", 
           "factornumm", ",", "factornumy", ",", "varstringx", ",", 
           "varstringm", ",", "varstringy"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\nSEM\:7d50\:69cb\:65b9\:7a0b\:5f0f\:6a21\:5f0f\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"thesisnoworrysem", "[", 
         RowBox[{
         "dataxx", ",", "datamm", ",", "datayy", ",", "factornumx", ",", 
          "factornumm", ",", "factornumy", ",", "varstringx", ",", 
          "varstringm", ",", "varstringy", ",", "semmicode"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "$cronbachtext"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "$mycfareporttotal"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworrysemxy", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "factornumx_", ",", "factornumm_", ",", 
      "varstringx_", ",", "varstringm_", ",", "semmicode_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "test", ",", "test1", ",", "test2", ",", "test3", ",", "semdmodel", 
        ",", "cfi", ",", "chi", ",", "df", ",", "chipv", ",", "rmsea", ",", 
        "xxrange", ",", "mmrange", ",", "yyrange", ",", "xloading", ",", 
        "mloading", ",", "yloading", ",", "XX", ",", "YY", ",", "MM", ",", 
        "regcoef", ",", "loadings", ",", "myreport", ",", "semdmodel2", ",", 
        "nnfi", ",", "gfi", ",", "agfi"}], "}"}], ",", 
      RowBox[{
       RowBox[{"test1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"dataxx", "[", 
               RowBox[{"[", 
                RowBox[{"z", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Accumulate", "@", "factornumx"}]}], ",", 
                   RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "2", ",", 
                 "1"}], "]"}]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"Length", "@", "dataxx"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"test2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"datamm", "[", 
               RowBox[{"[", 
                RowBox[{"z", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Accumulate", "@", "factornumm"}]}], ",", 
                   RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "2", ",", 
                 "1"}], "]"}]}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"Length", "@", "datamm"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"test", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Flatten", "/@", 
           RowBox[{"N", "@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{"test1", ",", "test2"}], "}"}]}]}]}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"varstringx", ",", "varstringm"}], "}"}]}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<test.csv\>\"", ",", "test"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:5404\:6982\:5ff5\:5e73\:5747\:6578\:53ca\:6a19\:6e96\:5dee\\n\>\
\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "z"}], "]"}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"Mean", "[", 
                  RowBox[{
                   RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "3"}], "}"}]}], "]"}], ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"StandardDeviation", "[", 
                  RowBox[{
                   RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", "3"}], "}"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\:6982\:5ff5\>\"", ",", "\"\<\:5e73\:5747\:6578\>\"", ",", 
             "\"\<\:6a19\:6e96\:5dee\>\""}], "}"}], ",", "1"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"semdmodel", "=", 
        RowBox[{"REvaluate", "[", 
         RowBox[{"\"\<{\n      \tda=data.frame(read.csv(\\\"\>\"", "<>", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"\"\<\\\\\>\"", "\[Rule]", "\"\<\\\\\\\\\>\""}]}], "]"}], 
          "<>", "\"\<test.csv\\\", header=T, sep=\\\",\\\"))\n      \t\
model<-'\n      \t# measurement model\n      \t\tXX=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringx", "]"}]}], "<>", 
          "\"\<\n      \t\tMM=~\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"Total", "[", "varstringm", "]"}]}], "<>", "\"\<\\n\>\"", "<>",
           "semmicode", "<>", "\"\<\\n\>\"", "<>", 
          "\"\<\n      \t# regressions\n      \t\tMM~XX\n      \t'\n      \t\
fit <- sem(model, data=da, estimator=\\\"\>\"", "<>", "semmethod", "<>", 
          "\"\<\\\")\n      \tmi <- modindices(fit)\n      \t\
capture.output(print(summary(fit, fit.measures=TRUE, standardized=TRUE)))\n   \
   \t}\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$sem", "=", "semdmodel"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"semdmodel2", "=", 
          RowBox[{"REvaluate", "[", "\"\< fitMeasures(fit)\>\"", "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
            "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
          RowBox[{
           RowBox[{"semdmodel2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{
             "3", ",", "4", ",", "5", ",", "9", ",", "11", ",", "23", ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "4"}]}], "}"}], "]"}], "]"}]}], ";"}], "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "chi", ",", "df", ",", "chipv", ",", "cfi", ",", "nnfi", ",", 
          "rmsea", ",", "gfi", ",", "agfi"}], "}"}], "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          "\"\<fitMeasures(fit,c(\\\"chisq\\\",\\\"df\\\",\\\"pvalue\\\",\\\"\
cfi\\\",\\\"nfi\\\",\\\"rmsea\\\",\\\"gfi\\\",\\\"agfi\\\"))\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$semmi", "=", 
        RowBox[{
         RowBox[{
         "REvaluate", "[", 
          "\"\<{\n      \tmi <- modindices(fit)\n      \tmi[mi$op == \\\"~~\\\
\",]\n      \tsubset(mi[mi$op == \\\"~~\\\",], mi > 5)\n      \t}\>\"", "]"}],
          "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\\n\>\""}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<\:5361\:65b9\:503c\>\"", ",", "\"\<\:81ea\:7531\:5ea6\>\"",
                ",", "\"\<P-value\>\"", ",", 
               "\"\<\:5361\:65b9\:503c/\:81ea\:7531\:5ea6\>\"", ",", 
               "\"\<CFI\>\"", ",", "\"\<NFI\>\"", ",", "\"\<RMSEA\>\"", ",", 
               "\"\<GFI\>\"", ",", "\"\<AGFI\>\""}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NumberForm", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"8", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"chi", ",", "df", ",", "chipv", ",", 
                RowBox[{"chi", "/", "df"}], ",", "cfi", ",", "nnfi", ",", 
                "rmsea", ",", "gfi", ",", "agfi"}], "}"}]}]}], "}"}]}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\:6307\:6a19\>\"", ",", 
               "\"\<\>\""}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6Modification \
Indices\:503c\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "$semmi", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xxrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<XX\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mmrange", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<MM\>\""}], "]"}], "&"}], "/@", 
            "semdmodel"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xxrange", "=", 
        RowBox[{
         RowBox[{"xxrange", "+", "1"}], ";;", 
         RowBox[{"xxrange", "+", 
          RowBox[{"Length", "@", "factornumx"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mmrange", "=", 
        RowBox[{
         RowBox[{"mmrange", "+", "1"}], ";;", 
         RowBox[{"mmrange", "+", 
          RowBox[{"Length", "@", "factornumm"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"XX", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "xxrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mloading", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MM", "\[Rule]", 
             RowBox[{"ToExpression", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\< \>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "9"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "mmrange", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xloading", ",", "mloading"}], "}"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"regcoef", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<MM ~\>\""}], "]"}], "&"}], "/@", 
              "semdmodel"}], ",", "True"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"regcoef", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"regcoef", "+", "2"}], ",", 
            RowBox[{"regcoef", "+", "4"}], ",", 
            RowBox[{"regcoef", "+", "5"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "@", 
            RowBox[{"Select", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[NotEqual]", "\"\<\>\""}], "&"}], ",", 
              "Infinity"}], "]"}]}], "&"}], "/@", 
          RowBox[{"StringSplit", "[", 
           RowBox[{
            RowBox[{"semdmodel", "[", 
             RowBox[{"[", "regcoef", "]"}], "]"}], ",", "\"\< \>\""}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"regcoef", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[NotEqual]", "\"\<\>\""}], "&"}], ",", 
             "Infinity"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "3"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"semdmodel", "[", 
            RowBox[{"[", "regcoef", "]"}], "]"}], ",", "\"\< \>\""}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"regcoef", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "@", 
             RowBox[{"regcoef", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[Rule]", "MM"}], 
           ",", 
           RowBox[{"ToExpression", "@", 
            RowBox[{"regcoef", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"regcoef", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"loadings", ",", "regcoef"}], "}"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"myreport", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "3"}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
         "myreport"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\:6e2c\:91cf\:6a21\:5f0f\:8207\:7d50\:69cb\:6a21\:5f0f\:6aa2\
\:5b9a\:5f59\:6574\:8868\\n\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", 
         RowBox[{"Insert", "[", 
          RowBox[{"myreport", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\:8def\:5f91\>\"", ",", 
             "\"\<\:6a19\:6e96\:5316\:8def\:5f91\:4fc2\:6578\>\"", ",", 
             "\"\<P-value\>\""}], "}"}], ",", "1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "@", 
        "\"\<\\n\:7814\:7a76\:67b6\:69cb\:8def\:5f91\:5716\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"XX", "\[Rule]", "#"}], "&"}], "/@", 
               RowBox[{"ToExpression", "@", "varstringx"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"MM", "\[Rule]", "#"}], "&"}], "/@", "varstringm"}], 
              ",", 
              RowBox[{"XX", "\[Rule]", "MM"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"VertexSize", "\[Rule]", "0.5"}], ",", 
          RowBox[{"VertexShapeFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ToExpression", "[", "#", "]"}], "\[Rule]", 
                  "\"\<Rectangle\>\""}], "&"}], "/@", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"varstringx", ",", "varstringm"}], "}"}], "]"}]}], 
               ",", 
               RowBox[{"XX", "\[Rule]", "\"\<Circle\>\""}], ",", 
               RowBox[{"MM", "\[Rule]", "\"\<Circle\>\""}]}], "}"}]}], 
            ")"}]}], ",", 
          RowBox[{"GraphLayout", "\[Rule]", "\"\<SpringEmbedding\>\""}], ",", 
          
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{"i", ",", "Center"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", 
                 RowBox[{
                 "XX", ",", "MM", ",", "varstringx", ",", "varstringm"}], 
                 "}"}]}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"EdgeLabels", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}], "\[Rule]", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
             RowBox[{"myreport", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ")"}]}]}], 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThesisNoWorryXM", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "factornumx_", ",", "factornumm_", ",", 
      "varstringx_", ",", "varstringm_", ",", "norminalvariableso_", ",", 
      "norminalstrings_", ",", "semmicode_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "cronbach", "}"}], ",", 
      RowBox[{
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"$mynote", ",", 
          RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\:6b21\:6578\:5206\:914d\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"PadLeft", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Dem", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}], "]"}]}], "*", 
                    "100"}], "//", "N"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
                    "\"\<%\>\""}]}], "}"}], ",", "3", ",", "\"\<\>\""}], 
                    "]"}]}], "&"}], "/@", 
                 RowBox[{"SortBy", "[", 
                  RowBox[{
                   RowBox[{"Tally", "@", 
                    RowBox[{"Dem", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "z"}], "]"}], "]"}]}], ",", "First"}],
                   "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"DemName", "[", 
                  RowBox[{"[", "z", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"Length", "@", "DemName"}]}], "}"}]}], "]"}], ",", 
            "1"}], "]"}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:4eba\:53e3\:8b8a\:9805\>\"", ",", "\"\<\:7d44\:5225\>\"",
                ",", "\"\<\:6b21\:6578\>\"", ",", 
               "\"\<\:767e\:5206\:6bd4\>\""}], "}"}]}], "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\:9805\:76ee\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:9805\:76ee\:5206\:6790-X\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"ItemAnalysis", "[", 
         RowBox[{"dataxx", ",", "factornumx"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\:9805\:76ee\:5206\:6790-M\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"ItemAnalysis", "[", 
         RowBox[{"datamm", ",", "factornumm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cronbach", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mycronbach", "[", 
               RowBox[{"dataxx", ",", "factornumx", ",", "varstringx"}], 
               "]"}], ",", 
              RowBox[{"mycronbach", "[", 
               RowBox[{"datamm", ",", "factornumm", ",", "varstringm"}], 
               "]"}]}], "}"}], ",", "1"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$cronbachtext", "=", "cronbach"}], ";", "\[IndentingNewLine]", 
       RowBox[{"$cronbachtext", "=", 
        RowBox[{
        "\"\<\:4fe1\:5ea6\:5206\:6790\\n \:6b64\:90e8\:5206\:91dd\:5c0d\:7814\
\:7a76\:67b6\:69cb\:4e2d\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Length", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"$cronbachtext", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "<>", 
         "\"\<\:500b\:6f5b\:5728\:8b8a\:9805\:4ee5\:53ca\:5404\:500b\:69cb\
\:9762\:9032\:884c\:4fe1\:5ea6\:7684\:8861\:91cf\:3002\:4e00\:822c Cronbach \
Alpha \:4fc2\:6578\:6700\:597d\:9054\:5230 0.70~0.98 \:4e4b\:9593\:ff0c\:4fbf\
\:53ef\:76f8\:4fe1\:6b64\:91cf\:8868\:69cb\:9762\:4e4b\:554f\:5377\:5177\:6709\
\:826f\:597d\:7684\:4fe1\:5ea6;\:82e5\:662f\:4fe1\:5ea6\:4f4e\:65bc 0.35 \
\:4fbf\:9808\:52a0\:4ee5\:62d2\:7d55\:3002\:672c\:7814\:7a76\:5c07\:4ee5\:6b64\
\:70ba\:5224\:65b7\:6e96\:5247\:ff0c\:5f59\:6574\:7d50\:679c\:5982\:8868 X\
\:ff0c\:7531\:8868 X \:53ef\:77e5\:ff0c\:672c\:7814\:7a76\:6f5b\:5728\:8b8a\
\:9805\:4ee5\:53ca\:5404\:500b\:69cb\:9762\:7684 Cronbach's \[Alpha] \:503c\
\:7686\:5927\:65bc \>\"", " ", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Min", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"ToExpression", "@", 
              RowBox[{"$cronbachtext", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "<>", 
         "\"\<\:ff0c\:8868\:793a\:6b64\:554f\:5377\:5177\:6709\:826f\:597d\
\:4fe1\:5ea6\:3002\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"cronbach", "=", 
          RowBox[{"Insert", "[", 
           RowBox[{"cronbach", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\:5404\:5206\:91cf\:8868\>\"", ",", 
              "\"\<Cronbach'\[Alpha]\>\"", ",", 
              "\"\<\:6574\:9ad4\:4fe1\:5ea6\>\""}], "}"}], ",", "1"}], 
           "]"}]}], ";"}], "*)"}], 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\:4fe1\:5ea6\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{"cronbach", ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:5404\:5206\:91cf\:8868\>\"", ",", 
               "\"\<Cronbach'\[Alpha]\>\"", ",", 
               "\"\<\:6574\:9ad4\:4fe1\:5ea6\>\""}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:4e00\:968eCFA\:6a21\:5f0f\:914d\:9069\:5ea6\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\:4e00\:968eCFA-X\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Quiet", "@", 
        RowBox[{"thesisnoworrycfa", "[", 
         RowBox[{"dataxx", ",", "factornumx", ",", "varstringx"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"$mycfareporttotal", "=", 
        RowBox[{"\"\<\\n\:4e00\:968eCFA-X\\n\>\"", "<>", "$mycfareport"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "\"\<\\n\:4e00\:968eCFA-M\\n\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Quiet", "@", 
        RowBox[{"thesisnoworrycfa", "[", 
         RowBox[{"datamm", ",", "factornumm", ",", "varstringm"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"$mycfareporttotal", "=", 
        RowBox[{
        "$mycfareporttotal", "<>", "\"\<\\n\:4e00\:968eCFA-M\\n\>\"", "<>", 
         "$mycfareport"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\:8b8a\:7570\:6578\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Quiet", "@", 
         RowBox[{"thesisnoworryanovaXM", "[", 
          RowBox[{
          "dataxx", ",", "datamm", ",", "factornumx", ",", "factornumm", ",", 
           "varstringx", ",", "varstringm", ",", "norminalvariableso", ",", 
           "norminalstrings"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\:968e\:5c64\:56de\:6b78\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"thesisnoworryhlmxm", "[", 
         RowBox[{
         "dataxx", ",", "datamm", ",", "factornumx", ",", "factornumm", ",", 
          "varstringx", ",", "varstringm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\nSEM\:7d50\:69cb\:65b9\:7a0b\:5f0f\:6a21\:5f0f\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Red"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"thesisnoworrysemxy", "[", 
         RowBox[{
         "dataxx", ",", "datamm", ",", "factornumx", ",", "factornumm", ",", 
          "varstringx", ",", "varstringm", ",", "semmicode"}], "]"}]}], ";", 
       RowBox[{"Print", "@", "$cronbachtext"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "$mycfareporttotal"}], ";"}]}], "\n", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworryhlmxm", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "factornumx_", ",", "factornumm_", ",", 
      "varstringx_", ",", "varstringm_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "datax", ",", "datam", ",", "datay", ",", "cronbach", ",", "numfx", 
        ",", "numfm", ",", "numfy", ",", "seqx", ",", "seqm", ",", "seqy", 
        ",", "newdatax", ",", "newdatam", ",", "newdatay", ",", "newdataxmy", 
        ",", "mycortest"}], "}"}], ",", 
      RowBox[{
       RowBox[{"datax", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"dataxx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "dataxx", ",", 
          RowBox[{"dataxx", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datam", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"datamm", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "datamm", ",", 
          RowBox[{"datamm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cronbach", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "&"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mycronbach", "[", 
               RowBox[{"datax", ",", "factornumx", ",", "varstringx"}], "]"}],
               ",", 
              RowBox[{"mycronbach", "[", 
               RowBox[{"datam", ",", "factornumm", ",", "varstringm"}], 
               "]"}]}], "}"}], ",", "1"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cronbach", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"cronbach", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Factor\>\"", ",", "\"\<Alpha\>\"", ",", 
            "\"\<Total Alpha\>\""}], "}"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numfx", "=", 
        RowBox[{"Length", "@", "factornumx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumx"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatax", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "/@", 
           RowBox[{"datax", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
         "seqx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfm", "=", 
        RowBox[{"Length", "@", "factornumm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqm", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumm"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatam", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "/@", 
           RowBox[{"datam", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
         "seqm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdataxmy", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newdatax", ",", "newdatam"}], "}"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mycortest", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "0.05"}], ",", 
             
             RowBox[{
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "<>", 
              "\"\<*\>\""}], ",", 
             RowBox[{
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "<>", 
              "\"\< \>\""}]}], "]"}], "&"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PearsonCorrelationTest", "[", 
               RowBox[{
                RowBox[{"newdataxmy", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"newdataxmy", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "\"\<TestDataTable\>\"",
                 ",", 
                RowBox[{"VerifyTestAssumptions", "\[Rule]", "None"}]}], "]"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "newdataxmy"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "@", "newdataxmy"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mycortest", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2"}], "}"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"{", 
                RowBox[{"varstringx", ",", "varstringm"}], "}"}]}], ",", 
              "mycortest"}], "}"}]}], "]"}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"varstringx", ",", "varstringm"}], "}"}]}]}], "}"}]}], 
          ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<\\n\:76f8\:95dc\:5206\:6790\\n\>\"", ",", 
          RowBox[{"mycortest", "//", "TableForm"}], ",", 
          "\"\<\\n\:968e\:5c64\:8ff4\:6b78\:5206\:6790\\n\>\"", ",", 
          RowBox[{
           RowBox[{"Insert", "[", 
            RowBox[{
             RowBox[{"myreg", "[", 
              RowBox[{"newdatax", ",", "newdatam"}], "]"}], ",", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"\"\<\>\"", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\"\<M\>\"", "<>", 
                    RowBox[{"ToString", "[", "#", "]"}]}], ",", "\"\<\>\""}], 
                   "}"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "@", "varstringm"}], "]"}]}]}], "}"}]}], 
             ",", "1"}], "]"}], "//", "TableForm"}]}], "}"}], "//", 
        "Column"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"thesisnoworryanovaXM", "[", 
     RowBox[{
     "dataxx_", ",", "datamm_", ",", "factornumx_", ",", "factornumm_", ",", 
      "varstringx_", ",", "varstringm_", ",", "norminalvariableso_", ",", 
      "norminalstrings_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "datax", ",", "datam", ",", "datay", ",", "cronbach", ",", "numfx", 
        ",", "numfm", ",", "numfy", ",", "seqx", ",", "seqm", ",", "seqy", 
        ",", "newdatax", ",", "newdatam", ",", "newdatay", ",", "newdataxmy", 
        ",", "numfn", ",", "dataanova", ",", "norminalvariables", ",", 
        "norminalvariablesnum", ",", "norminalvariablepos"}], "}"}], ",", 
      RowBox[{
       RowBox[{"datax", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"dataxx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "dataxx", ",", 
          RowBox[{"dataxx", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datam", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"datamm", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "datamm", ",", 
          RowBox[{"datamm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numfx", "=", 
        RowBox[{"Length", "@", "factornumx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumx"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatax", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", "Mean"}], "/@", 
             RowBox[{"datax", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
           "seqx"}], ",", 
          RowBox[{"Mean", "/@", "dataxx"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numfm", "=", 
        RowBox[{"Length", "@", "factornumm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seqm", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Accumulate", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "factornumm"}], "}"}]}], "]"}], ",", "2", ",",
            "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdatam", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mean", "/@", 
             RowBox[{"datam", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"Range", "@@", "#"}]}], "]"}], "]"}]}], "&"}], "/@", 
           "seqm"}], ",", 
          RowBox[{"Mean", "/@", "datamm"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newdataxmy", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newdatax", ",", "newdatam"}], "}"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"numfy", "=", 
        RowBox[{"Length", "@", "norminalstrings"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"norminalvariables", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumericQ", "@", 
             RowBox[{"norminalvariableso", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
            "norminalvariableso", ",", 
            RowBox[{"norminalvariableso", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
       RowBox[{"norminalvariables", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"norminalvariableso", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
          "norminalvariableso", ",", "norminalvariableso"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataanova", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", "norminalvariables", "]"}], ",", 
          "newdataxmy"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dataanova", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"myanova", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Transpose", "[", "norminalvariables", "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "newdataxmy"}], "}"}]}], "]"}], ",", "2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"norminalvariablesnum", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Tally", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", "norminalvariables", "]"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dataanova", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"PadRight", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"norminalvariablesnum", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], "]"}], 
                "&"}], "/@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringx", ",", "\"\<X\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringm", ",", "\"\<M\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}], "}"}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "norminalvariablesnum"}]}], "}"}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"Transpose", "@", "dataanova"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norminalvariablepos", "=", 
        RowBox[{
         RowBox[{"\"\<\>\"", "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", 
           RowBox[{"dataanova", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dataanova", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "#", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "0.00001"}], ",", "0.00001", ",", "#"}], 
             "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"dataanova", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norminalvariablepos", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"1", "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Accumulate", "[", 
                RowBox[{"norminalvariablesnum", "*", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringx", ",", "\"\<X\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"varstringm", ",", "\"\<M\:6574\:9ad4\>\"", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}], "]"}]}], 
                "]"}]}], "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], "]"}], "=", 
        "norminalstrings"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"10", ",", "3"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"Transpose", "@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "norminalvariablepos", "}"}], ",", 
               RowBox[{"N", "@", "dataanova"}]}], "]"}]}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\:4eba\:53e3\:7d71\:8a08\:8b8a\:6578\>\"", ",", 
            "\"\<\:56e0\:7d20\>\"", ",", "\"\<\:7d44\:5225\>\"", ",", 
            "\"\<\:5e73\:5747\:6578\>\"", ",", "\"\<\:6a19\:6e96\:5dee\>\"", 
            ",", "\"\<F\:503c\>\"", ",", "\"\<P \:503c\>\"", ",", 
            "\"\<\:4e8b\:5f8c\:6bd4\:8f03\>\""}], "}"}], ",", "1"}], "]"}], "//",
         "TableForm"}]}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"varimax", "[", "data_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "AA", ",", "BB", ",", "CC", ",", "DD", ",", "nn", ",", "uu", ",", "XX",
         ",", "YY", ",", "vdata", ",", "angle", ",", "Tr", ",", "temp", ",", 
        "vlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nn", ",", "uu"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "data", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vdata", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Normalize", ",", "data"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"angle", "=", 
           RowBox[{
            RowBox[{"Arg", "[", 
             RowBox[{
              RowBox[{"nn", "*", " ", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"Complex", "[", 
                   RowBox[{
                    RowBox[{"vdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"iter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"vdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"iter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                  "]"}], "^", "4"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"Complex", "[", 
                   RowBox[{
                    RowBox[{"vdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"iter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"vdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"iter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
                  "]"}], "^", "2"}], "]"}], "^", "2"}]}], "]"}], "/", "4"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Tr", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "angle", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Sin", "[", "angle", "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "angle", "]"}], ",", 
               RowBox[{"Cos", "[", "angle", "]"}]}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"vdata", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "iter"}], "]"}], "]"}], "=", " ", 
           RowBox[{
            RowBox[{"vdata", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "iter"}], "]"}], "]"}], ".", "Tr"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"iter", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subsets", "[", 
                RowBox[{
                 RowBox[{"Range", "[", "uu", "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "[", "25", "]"}]}], ",", "1"}], "]"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"vdata", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], "/@", "data"}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myfactor", "[", "data_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "label", ",", "fadata", ",", "mypca", ",", "loadings", ",", "nf", ",", 
        "rotatedloadings", ",", "rotatedfactor", ",", "ncfa", ",", "proddata",
         ",", "rlabel", ",", "rcode", ",", "rindex1", ",", "rindex2", ",", 
        "rindex3", ",", "cfareport", ",", "rave", ",", "rcr", ",", "ravepos", 
        ",", "fdv"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$myfactorrule", "=", 
        RowBox[{"Rule", "@@@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\"\<V\>\"", "<>", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "<", "10"}], ",", 
                 RowBox[{"\"\<0\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", 
                 RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "&"}], "/@", 
             
             RowBox[{"Range", "[", 
              RowBox[{"Length", "@", "label"}], "]"}]}], ",", "label"}], 
           "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fadata", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$iterfactor", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<\\n\:9805\:76ee\:5206\:6790\\n\>\"", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"fadata", ",", "label"}], "}"}], "=", 
          RowBox[{"myitemanalysis", "[", 
           RowBox[{"fadata", ",", "label"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mypca", "=", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{"Correlation", "@", "fadata"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"mypca", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", ">=", "1"}], "&"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mypca", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "#"}], "]"}], "]"}], "^", "0.5"}], "*", 
            RowBox[{"mypca", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "#"}], "]"}], "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", "nf", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotatedloadings", "=", 
        RowBox[{"varimax", "[", "loadings", "]"}]}], ";", 
       "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"rotatedloadings", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<\>\"", ",", 
             "\"\<\>\""}], "}"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", "loadings"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotatedfactor", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"loadings", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "==", 
               RowBox[{"Max", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"Abs", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"1", "+", "nf"}]}], "]"}], "]"}]}], "]"}], 
                "]"}]}], ")"}], "&"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"nf", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$xx5", "=", "rotatedfactor"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"rotatedfactor", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1", ",", 
               RowBox[{"nf", "+", "2"}]}], "]"}], "]"}], "=", 
            RowBox[{"mypca", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "#"}], "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"rotatedfactor", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1", ",", 
               RowBox[{"nf", "+", "3"}]}], "]"}], "]"}], "=", 
            RowBox[{"PercentForm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Accumulate", "[", 
                RowBox[{"mypca", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", "#", "]"}], "]"}], "/", 
              RowBox[{"Total", "[", 
               RowBox[{"mypca", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}], 
          ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", "nf", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:63a2\:7d22\:6027\:56e0\:7d20\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "#", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                 "\"\<0.000\>\"", ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
               "#"}], "]"}], "&"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"StringReplace", "[", 
                    RowBox[{
                    RowBox[{"label", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"\"\< \>\"", "->", "\"\<\>\""}]}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
                 RowBox[{"rotatedfactor", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "nf"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
            ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", " ", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", 
               RowBox[{"\"\<\:984c\:9805\>\"", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\"\<\:56e0\:7d20\>\"", "<>", 
                   RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
                 RowBox[{"Range", "[", "nf", "]"}]}], ",", 
                "\"\<\:7279\:5fb5\:6839\>\"", ",", 
                "\"\<\:89e3\:91cb\:767e\:5206\:6bd4\>\""}], "}"}]}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ncfa", "=", 
        RowBox[{"Length", "/@", "rotatedfactor"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"proddata", "=", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
              "rotatedfactor"}], "]"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"$zxc", "=", "rotatedfactor"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rlabel", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", "10"}], ",", 
             RowBox[{"\"\<V0\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<V\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}], "&"}], ",", 
          "rotatedfactor", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rcode", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"\"\<myrdata = data.frame(\\n\>\"", "<>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<V\>\"", "<>", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "<", "10"}], ",", 
                 RowBox[{"\"\<0\>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], ",", 
                 RowBox[{"ToString", "[", "#", "]"}]}], "]"}], 
               "\[IndentingNewLine]", "<>", "\"\< = c\>\"", "<>", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<{\>\"", "->", "\"\<(\>\""}], ",", 
                   RowBox[{"\"\<}\>\"", "->", 
                    RowBox[{"\"\<),\>\"", "<>", "\"\<\\n\>\""}]}]}], "}"}]}], 
                "]"}]}], "&"}], "/@", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"rotatedfactor", ",", "1"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}], "<>", 
           "\"\<)\>\""}], ",", 
          RowBox[{"\"\<),\\n)\>\"", "->", "\"\<)\\n)\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$rcode", "=", "rcode"}], ";", "\[IndentingNewLine]", 
       RowBox[{"$rlabel", "=", "rlabel"}], ";", "\[IndentingNewLine]", 
       RowBox[{"rcode", "=", 
        RowBox[{"rcode", "<>", "\"\<\\nrcfa<-'\\n\>\"", "<>", 
         RowBox[{"StringJoin", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\"\<F\>\"", "<>", 
                 RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<=~\>\""}], 
                "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "$rlabel"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Total", "[", "#", "]"}], "]"}], "&"}], "/@", 
               "$rlabel"}], ",", 
              RowBox[{
               RowBox[{"\"\<\\n\>\"", "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "$rlabel"}], "]"}]}]}], "}"}], "]"}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rcode", "=", 
        RowBox[{
        "\"\<{\\n\>\"", "<>", "rcode", "<>", "\"\<'\\n\>\"", "<>", 
         "\[IndentingNewLine]", 
         "\"\<fit <- cfa(rcfa, data=myrdata, \
estimator=\\\"ML\\\")\\nfitMeasures(fit, c(\\\"chisq\\\", \\\"df\\\", \
\\\"pvalue\\\", \\\"cfi\\\",\\\"nfi\\\", \\\"rmsea\\\", \
\\\"gfi\\\",\\\"agfi\\\"), \n            output = \
\\\"matrix\\\")\\n}\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$rcode", "=", "rcode"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rindex1", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"REvaluate", "[", "rcode", "]"}], ",", 
          RowBox[{
           RowBox[{"{", "x_", "}"}], ":>", "x"}], ",", "Infinity"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rindex2", "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{
          RowBox[{
          "REvaluate", "[", 
           "\"\<{parameterEstimates(fit, standardized = TRUE, output = \
\\\"text\\\")}\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rindex3", "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{
          RowBox[{
          "REvaluate", "[", "\"\<{standardizedSolution(fit)}\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$rindex2", "=", "rindex2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\:4fe1\:5ea6\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "#", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                 "\"\<0.000\>\"", ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
               "#"}], "]"}], "&"}], ",", 
            RowBox[{"mycronbach", "[", "\[IndentingNewLine]", 
             RowBox[{"proddata", ",", "ncfa", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<Factor \>\"", "<>", 
                 RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", "nf", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"TableHeadings", "->", 
           RowBox[{"{", 
            RowBox[{"None", ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:56e0\:7d20\>\"", ",", "\"\<Cronbach's \[Alpha]]\>\"", 
               ",", "\"\<\:6574\:9ad4 Cronbach's \[Alpha]\>\""}], "}"}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:9a57\:8b49\:6027\:56e0\:7d20\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$factorlabel", "=", "label"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<\\n\:6a21\:5f0f\:914d\:9069\:5ea6\:6307\:6a19\\n\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
            RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "#", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                 "\"\<0.000\>\"", ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
               "#"}], "]"}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\:5361\:65b9\:503c\>\"", ",", 
                    "\"\<\:81ea\:7531\:5ea6\>\"", ",", "\"\<P-value\>\"", 
                    ",", "\"\<CFI\>\"", ",", "\"\<NFI\>\"", ",", 
                    "\"\<RMSEA\>\"", ",", "\"\<GFI\>\"", ",", 
                    "\"\<AGFI\>\""}], "}"}], ",", "rindex1"}], "}"}], "]"}], 
               ",", "8"}], "]"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:6a21\:5f0f\:914d\:9069\:5ea6\:6307\:6a19\>\"", ",", 
               "\"\<\>\""}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cfareport", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"Insert", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"rindex2", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", 
                 RowBox[{"-", "1"}], ",", "8"}], "}"}]}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"Length", "@", "label"}]}], "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"Missing", "[", "]"}], "->", "\"\<\>\""}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ravepos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rindex2", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "8"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"Length", "@", "label"}]}], "]"}], "]"}], ",", 
           RowBox[{"Missing", "[", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rave", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "^", "2"}], 
           "/", 
           RowBox[{"Length", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "&"}], "/@", 
         RowBox[{"GatherBy", "[", 
          RowBox[{"cfareport", ",", "First"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rcr", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "^", "2"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "^", "2"}], 
             "+", 
             RowBox[{"Length", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "^", "2"}], "]"}]}],
             ")"}]}], "&"}], "/@", 
         RowBox[{"GatherBy", "[", 
          RowBox[{"cfareport", ",", "First"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"cfareport", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"ravepos", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "5"}], "]"}], "]"}], "=", 
           
           RowBox[{"rave", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "rave"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"cfareport", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"ravepos", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "6"}], "]"}], "]"}], "=", 
           
           RowBox[{"rcr", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "rave"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:56e0\:7d20\:8ca0\:8377\:3001\:805a\:5408\:6548\:5ea6\\n\>\"\
", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "#", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                 "\"\<0.000\>\"", ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
               "#"}], "]"}], "&"}], ",", 
            RowBox[{"cfareport", "/.", "$myfactorrule"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:6982\:5ff5\>\"", ",", "\"\<\:984c\:9805\>\"", ",", 
               "\"\<\:56e0\:7d20\:8ca0\:8377\>\"", ",", "\"\<P-value\>\"", 
               ",", "\"\<AVE\>\"", ",", "\"\<CR\>\""}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cfareport", "=", 
        RowBox[{
         RowBox[{"rindex3", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "4", ",", "8", ",", "9"}], "}"}]}], 
           "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Length", "@", "rotatedfactor"}], ")"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"(", 
                  RowBox[{"Length", "@", "rotatedfactor"}], ")"}]}], ")"}], 
               "/", "2"}]}], ")"}]}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"cfareport", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cfareport", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", "#"}], "}"}], "->", 
                  RowBox[{
                   RowBox[{"rave", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "^", "0.5"}]}], "}"}], 
                "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "rave"}], "]"}]}]}], "}"}], ",", "2"}],
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "@", 
          RowBox[{"MatrixForm", "@", 
           RowBox[{"SparseArray", "[", "cfareport", "]"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cfareport", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<\:8207\>\"", 
             "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], "&"}], "/@", 
         "cfareport"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:5340\:5225\:6548\:5ea6\:ff0cAnderson and Gerbing (1988) \
\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "#", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                 "\"\<0.000\>\"", ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
               "#"}], "]"}], "&"}], ",", "cfareport", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:8b8a\:6578\>\"", ",", 
               "\"\<\:6a19\:6e96\:5316\:76f8\:95dc\:4fc2\:6578\>\"", ",", 
               "\"\<95%\:4fe1\:8cf4\:4e0b\:754c\>\"", ",", 
               "\"\<95%\:4fe1\:8cf4\:4e0a\:754c\>\""}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:8a3b\:ff1aAnderson and Gerbing (1988) \:63d0\:51fa\:4e4b\
\:4fe1\:8cf4\:5340\:9593\:6aa2\:5b9a (confidence interval test)\:ff0c\:9032\
\:884c\:9a57\:8b49\:3002\\n\:5c0d\:4efb\:610f\:4e8c\:4e0d\:540c\:69cb\:5ff5\
\:ff0c\:f974\:5176\:76f8\:95dc\:4fc2\:f969\:4e4b confidence interval \:672a\
\:5305\:542b1\:6216\[Minus]1\:ff0c\:5247\:62d2\:7d55\:8a72\:4e8c\:69cb\:5ff5\
\:9593\:4e4b\:5b8c\:5168\:76f8\:95dc\:6027\:ff0c\:8868\:8a72\:4e8c\:69cb\:5ff5\
\:5177\:5340\:5225\:6548\:5ea6\:3002\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fdv", "=", 
        RowBox[{"Correlation", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"Mean", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"fadata", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
              "&"}], "/@", "rotatedfactor"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fdv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", ">", "i"}], ",", "\"\<\>\"", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "==", "j"}], ",", 
              RowBox[{
               RowBox[{"rave", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "^", "0.5"}], ",", 
              RowBox[{"fdv", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "rave"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "rave"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:5340\:5225\:6548\:5ea6\:ff0cFornell and Larcker (1981) \\n\
\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "@", 
         RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NumberQ", "[", "#", "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                  "\"\<0.000\>\"", ",", 
                  RowBox[{"ToString", "@", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
                "#"}], "]"}], "&"}], ",", "fdv", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\"\<Factor \>\"", "<>", 
                 RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", "nf", "]"}]}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<Factor \>\"", "<>", 
                 RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", "nf", "]"}]}]}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\\n\:8a3b\:ff1a Fornell and Larcker (1981)\:63d0\:51fa\:4e8c\
\:69cb\:9762\:7684\:76f8\:95dc\:4fc2\:6578\:5c0f\:65bcAVE\:4e4b\:5e73\:65b9\
\:6839\:ff0c\:5247\:8868\:793a\:6b64\:4e8c\:69cb\:9762\:5177\:6709\:5340\:5225\
\:6548\:5ea6\:3002\\n\>\"", ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
           RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}], "]"}]}], ";"}]}],
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "@", 
        RowBox[{"thesisnoworrycfa", "[", "\[IndentingNewLine]", 
         RowBox[{"proddata", ",", "ncfa", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<X\>\"", "<>", 
              RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", "nf", "]"}]}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myfactorcheck", "[", "data_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "label", ",", "fadata", ",", "mypca", ",", "loadings", ",", "nf", ",", 
        "rotatedloadings", ",", "rotatedfactor", ",", "ncfa", ",", "proddata",
         ",", "check", ",", "checkfactornum"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fadata", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$iterfactor", "=", 
        RowBox[{"$iterfactor", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"\"\<\\n\:7b2c\>\"", "<>", 
           RowBox[{"ToString", "[", "$iterfactor", "]"}], "<>", 
           "\"\<\:8f2a\:56e0\:7d20\:5206\:6790\>\""}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n\:9805\:76ee\:5206\:6790\\n\>\"", ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fadata", ",", "label"}], "}"}], "=", 
        RowBox[{"myitemanalysis", "[", 
         RowBox[{"fadata", ",", "label"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mypca", "=", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{"Correlation", "@", "fadata"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"mypca", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", ">=", "1"}], "&"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mypca", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "#"}], "]"}], "]"}], "^", "0.5"}], "*", 
            RowBox[{"mypca", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "#"}], "]"}], "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", "nf", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotatedloadings", "=", 
        RowBox[{"varimax", "[", "loadings", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadings", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"rotatedloadings", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "\"\<\>\"", ",", 
             "\"\<\>\""}], "}"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "@", "loadings"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotatedfactor", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"loadings", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "==", 
               RowBox[{"Max", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"Abs", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"1", "+", "nf"}]}], "]"}], "]"}]}], "]"}], 
                "]"}]}], ")"}], "&"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"nf", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xx1$", "=", "rotatedfactor"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\\n\:9805\:76ee\:5206\:6790\\n\>\"", ",", 
            RowBox[{"FontColor", "\[Rule]", "Red"}], ",", 
            RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ItemAnalysis", "[", 
          RowBox[{"fadata", ",", 
           RowBox[{"Length", "/@", "rotatedfactor"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rotatedfactor", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Insert", "[", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"rotatedfactor", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"rotatedfactor", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
         
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "rotatedfactor", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"check", "[", 
         RowBox[{"list_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"temp", "=", "list"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", "j"}], "]"}], "]"}], "]"}], "<", "0.45"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "+", "nf"}], "]"}], "]"}], "=", 
               RowBox[{"\"\<Factor \>\"", "<>", 
                RowBox[{"ToString", "[", "j", "]"}]}]}], ";", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"3", "+", "nf"}], "]"}], "]"}], "=", 
               "\"\<\:56e0\:7d20\:8ca0\:8377\:904e\:4f4e\>\""}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "+", "nf"}], "]"}], "]"}], "=", 
               RowBox[{"\"\<Factor \>\"", "<>", 
                RowBox[{"ToString", "[", "j", "]"}]}]}], ";", 
              RowBox[{
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"3", "+", "nf"}], "]"}], "]"}], "=", 
               RowBox[{"temp", "[", 
                RowBox[{"[", 
                 RowBox[{"3", "+", "nf"}], "]"}], "]"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Sort", "[", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"temp", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", "j"}], "]"}], "]"}], "]"}], "-", 
                  RowBox[{
                   RowBox[{"Abs", "[", "temp", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"1", "+", "nf"}]}], "]"}], "]"}]}], "]"}], "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<", "0.05"}], ",", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"3", "+", "nf"}], "]"}], "]"}], "=", 
              "\"\<\:4ea4\:53c9\:8ca0\:8377\>\""}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            StyleBox[
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Sort", "[", 
                   RowBox[{
                    RowBox[{"Abs", "[", "temp", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"1", "+", "nf"}]}], "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], ">", "0.6"}], ",", 
                RowBox[{
                 RowBox[{"temp", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", "+", "nf"}], "]"}], "]"}], "=", 
                 "\"\<\:4ea4\:53c9\:8ca0\:8377\>\""}]}], "]"}], ";"}],
             FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "@", "temp"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "temp"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       RowBox[{"xx2$", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"check", "[", 
              RowBox[{"#", ",", "i"}], "]"}], "&"}], ",", 
            RowBox[{"rotatedfactor", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nf"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"check", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], "==", 
                 "\"\<\:56e0\:7d20\:8ca0\:8377\:904e\:4f4e\>\""}], "||", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], "==", 
                 "\"\<\:4ea4\:53c9\:8ca0\:8377\>\""}], "||", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "\[LessEqual]", "2"}]}], 
               "&"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"check", "[", 
                 RowBox[{"#", ",", "i"}], "]"}], "&"}], ",", 
               RowBox[{"rotatedfactor", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nf"}], "}"}]}], "]"}]}], ",", "1"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:4ee5\:4e0b\:984c\:9805\:56e0\:6982\:5ff5\:984c\:6578\:592a\
\:5c11\:3001\:56e0\:7d20\:8ca0\:8377\:904e\:4f4e\:6216\:4ea4\:53c9\:8ca0\:8377\
\:4e88\:4ee5\:5254\:9664\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "@", "check"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Dimensions", "[", "data", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"check", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myitemanalysis", "[", 
     RowBox[{"data_", ",", "testvars_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "testdata", ",", "itemcorrel", ",", "nosigdata", ",", "quan", ",", 
        "itemsum", ",", "class", ",", "nc", ",", "nr"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"testdata", "=", "data"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nr", ",", "nc"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "testdata", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"quan", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"Total", "/@", 
           RowBox[{"testdata", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.27", ",", "0.73"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itemsum", "=", 
        RowBox[{"Total", "/@", "testdata"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"itemcorrel", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{"Correlation", "[", 
              RowBox[{"itemsum", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "#"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"Range", "[", "nc", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Insert", "[", 
             RowBox[{
              RowBox[{"testdata", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"itemsum", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ">", 
                 RowBox[{"quan", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", "1", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"itemsum", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "<", 
                   RowBox[{"quan", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "0", ",", 
                  "\"\<\>\""}], "]"}]}], "]"}], ",", "1"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", "nr", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "!=", "\"\<\>\""}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "/@", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"testvars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"itemcorrel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<\>\""}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"Length", "@", "#"}], ",", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"StandardDeviation", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}], 
                   "&"}], "/@", 
                  RowBox[{"GatherBy", "[", 
                   RowBox[{
                    RowBox[{"testdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}]}], "]"}], "]"}], ",", 
                    "First"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "0.0001"}], ",", "\"\<0.000\>\"", ",", 
                    "#"}], "]"}], "&"}], "[", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"TTest", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"GatherBy", "[", 
                    RowBox[{
                    RowBox[{"testdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}]}], "]"}], "]"}], ",", 
                    "First"}], "]"}]}], ",", "0", ",", 
                    RowBox[{
                    "VerifyTestAssumptions", "\[Rule]", 
                    "\"\<EqualVariance\>\""}]}], "]"}]}], "]"}], ",", 
                   "\"\<\>\""}], "}"}]}], "}"}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "->", "\"\<\:4f4e\:5206\:7d44\>\""}], ",", 
               RowBox[{"1", "->", "\"\<\:9ad8\:5206\:7d44\>\""}]}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "nc"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{"testdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{
            "1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "2"}],
             "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumberQ", "[", "#", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "#", "]"}], "<", "0.00001"}], ",", 
                 "\"\<0.000\>\"", ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}]}], "]"}], ",", 
               "#"}], "]"}], "&"}], ",", "testdata", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TableHeadings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"None", ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\:8b8a\:6578\>\"", ",", "\"\<\:9ad8\:4f4e\:5206\:7d44\>\"",
                ",", "\"\<\:6a23\:672c\:6578\>\"", ",", 
               "\"\<\:5e73\:5747\:6578\>\"", ",", 
               "\"\<\:6a19\:6e96\:5dee\>\"", ",", 
               "\"\<\:986f\:8457\:503c\>\"", ",", 
               "\"\<\:8207\:7e3d\:5206\:76f8\:95dc\:4fc2\:6578\>\""}], 
              "}"}]}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"testdata", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"testdata", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "!=", "\"\<\>\""}], "&"}]}], 
          "]"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#2", "]"}], ",", "#1"}], "}"}]}]}], 
           "&"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{"testdata", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "!=", "\"\<\>\""}], "&"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nosigdata", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"testdata", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], ">", "0.05"}], "||", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "<", "0.3"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\\n\:4ee5\:4e0b\:984c\:9805\:4e0d\:4ff1\:9452\:5225\:529b\:6216\
\:8207\:7e3d\:5206\:76f8\:95dc\:4fc2\:6578\:904e\:4f4e\\n\>\"", ",", 
          RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
          RowBox[{"FontColor", "\[Rule]", "Red"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Quiet", "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "nosigdata"}], "==", "0"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\:5168\:6578\:8b8a\:6578\:7686\:4ff1\:9452\:5225\:529b\>\"", 
             ",", 
             RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
             RowBox[{"FontColor", "\[Rule]", "Blue"}]}], "]"}], ",", 
           RowBox[{"TableForm", "[", "nosigdata", "]"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"testdata", "=", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"testdata", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}], "<", "0.05"}], "&&", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "]"}], ">", "0.3"}]}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"xx9$", "=", "testdata"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Length", "@", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "testdata"}], "]"}], "]"}]}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "testdata"}], "]"}], "]"}], ",", 
         RowBox[{"testvars", "[", 
          RowBox[{"[", "testdata", "]"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n"}], "Input",
 CellChangeTimes->{{3.805239132617696*^9, 3.805239146456093*^9}, 
   3.805242538921146*^9, {3.805242576285191*^9, 3.805242600064599*^9}, {
   3.805244179524418*^9, 3.8052441796987467`*^9}, {3.805244218622534*^9, 
   3.805244221547913*^9}, {3.805244286647112*^9, 3.805244287857231*^9}, {
   3.805244608677761*^9, 3.805244656494957*^9}, 3.8052448120774183`*^9, {
   3.805246040163287*^9, 3.805246060458695*^9}, {3.8053202587133923`*^9, 
   3.8053203014977016`*^9}, {3.805320797810582*^9, 3.805320832578178*^9}, {
   3.805320873311055*^9, 3.805320905841275*^9}, {3.805320941039193*^9, 
   3.805320969016591*^9}, {3.805321264204452*^9, 3.805321322782632*^9}, {
   3.80532208358112*^9, 3.8053222766852407`*^9}, {3.805322349807642*^9, 
   3.805322362691856*^9}, {3.805322560320071*^9, 3.805322585219842*^9}, {
   3.8053226812468367`*^9, 3.805322699540279*^9}, 3.805322745580969*^9, {
   3.805322787592538*^9, 3.805322807552616*^9}, {3.805322849775914*^9, 
   3.805322856476927*^9}, {3.805322891732033*^9, 3.805322955251981*^9}, {
   3.80536156976084*^9, 3.805361600952366*^9}, {3.805361738391149*^9, 
   3.805361739029505*^9}, 3.805412173533231*^9, {3.8054122493580227`*^9, 
   3.8054122549976263`*^9}, 3.805412289813249*^9, 3.8054127382775183`*^9, {
   3.8054137055843067`*^9, 3.8054137059550858`*^9}, {3.805413738198152*^9, 
   3.805413738490921*^9}, 3.8054139729888897`*^9, {3.8057604895648518`*^9, 
   3.80576055748868*^9}, {3.813675862303569*^9, 3.813675884424876*^9}, {
   3.8136759210714293`*^9, 3.813675921235305*^9}, {3.813676022492429*^9, 
   3.813676022700076*^9}, {3.813676472925202*^9, 3.813676480595186*^9}, {
   3.813676604318543*^9, 3.81367660646423*^9}, {3.8205383316896405`*^9, 
   3.82053833406465*^9}, {3.820538563002139*^9, 3.8205385647833943`*^9}, {
   3.8348402171333733`*^9, 3.834840264063719*^9}, {3.8348723041039667`*^9, 
   3.8348723170329247`*^9}, 3.834873220164855*^9, {3.8349617187025623`*^9, 
   3.834961754545519*^9}, {3.83512000527404*^9, 3.835120011767252*^9}, 
   3.835129594024768*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"3fb50c56-1853-4c56-ba21-381ab2a383fb"],

Cell[BoxData[
 RowBox[{"{", "\<\"R version 4.1.0 (2021-05-18)\"\>", "}"}]], "Print",
 CellChangeTimes->{
  3.805239147911289*^9, 3.805239207562628*^9, 3.8052392405814857`*^9, 
   3.8052422266101522`*^9, 3.8052425401611013`*^9, 3.8052441272663727`*^9, 
   3.805244185413546*^9, 3.805244230360257*^9, 3.8052460767462807`*^9, 
   3.80526502167437*^9, 3.805320320897735*^9, 3.805320359914134*^9, 
   3.805320876685216*^9, {3.8053209124547462`*^9, 3.805320941962818*^9}, 
   3.805321333562149*^9, 3.8053220962239113`*^9, 3.805322279530347*^9, 
   3.805322364911439*^9, 3.805322586364729*^9, 3.805322628514472*^9, 
   3.805322700448567*^9, 3.805322808708399*^9, 3.805322859462142*^9, 
   3.805361378644665*^9, 3.805361657495894*^9, 3.805410663630978*^9, 
   3.8054107848238297`*^9, 3.8054122607050667`*^9, 3.805412460828519*^9, 
   3.805413922858452*^9, 3.8054139566297083`*^9, 3.8057594183178673`*^9, 
   3.805759927075428*^9, 3.8057602186267443`*^9, 3.8057605200187817`*^9, 
   3.805760558527466*^9, 3.8133019473803997`*^9, 3.813302050171261*^9, 
   3.813303298338738*^9, 3.813400458192934*^9, 3.813675403198875*^9, 
   3.813675922041685*^9, 3.813676023189362*^9, 3.8136764954505444`*^9, 
   3.813676618089991*^9, 3.8205383540806303`*^9, 3.824422414042258*^9, {
   3.824423412150791*^9, 3.824423423383383*^9}, 3.824424634327193*^9, 
   3.824424670595367*^9, {3.824424700853999*^9, 3.824424711128417*^9}, 
   3.824424741484626*^9, 3.83466624557682*^9, 3.834839888211851*^9, 
   3.834839944521245*^9, 3.834871924396784*^9, {3.834872325924823*^9, 
   3.83487233552699*^9}, 3.83489041858908*^9, 3.834961582166215*^9, 
   3.834976749058201*^9, 3.835042816370213*^9, 3.8350594372432747`*^9, 
   3.835063418700807*^9, 3.835063503733897*^9, {3.835063564015141*^9, 
   3.835063592236064*^9}, 3.83506389833908*^9, 3.835069083283175*^9, 
   3.8350788516938963`*^9, 3.835129585859956*^9, 3.8351296186340427`*^9, {
   3.835129692044168*^9, 3.835129715799385*^9}},
 CellLabel->
  "During evaluation of \
In[72]:=",ExpressionUUID->"8d6dc626-a71b-400b-bae4-240bd7a37b45"]
}, Open  ]]
},
WindowSize->{995, 684},
WindowMargins->{{Automatic, 47}, {0, Automatic}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"493881fd-f770-4d39-a26e-a7c40ef9a53e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 275217, 6856, 19560, "Input",ExpressionUUID->"3fb50c56-1853-4c56-ba21-381ab2a383fb"],
Cell[275642, 6873, 2051, 31, 24, "Print",ExpressionUUID->"8d6dc626-a71b-400b-bae4-240bd7a37b45"]
}, Open  ]]
}
]
*)

